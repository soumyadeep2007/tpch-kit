                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Gather Motion 3:1  (slice1; segments: 3)  (cost=896276.41..896290.58 rows=1000 width=16) (actual time=30286.539..30286.571 rows=45 loops=1)
   Merge Key: (count(*)), (count(orders.o_orderkey))
   ->  Sort  (cost=896276.41..896277.24 rows=333 width=16) (actual time=30284.034..30284.052 rows=17 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method:  quicksort  Memory: 75kB
         Executor Memory: 177kB  Segments: 3  Max: 59kB (segment 0)
         ->  Finalize HashAggregate  (cost=896259.11..896262.44 rows=333 width=16) (actual time=30283.837..30283.845 rows=17 loops=1)
               Group Key: (count(orders.o_orderkey))
               Peak Memory Usage: 0 kB
               ->  Redistribute Motion 3:3  (slice2; segments: 3)  (cost=896224.11..896254.11 rows=1000 width=16) (actual time=30079.677..30283.761 rows=51 loops=1)
                     Hash Key: (count(orders.o_orderkey))
                     ->  Partial HashAggregate  (cost=896224.11..896234.11 rows=1000 width=16) (actual time=30181.324..30181.341 rows=45 loops=1)
                           Group Key: count(orders.o_orderkey)
                           Peak Memory Usage: 0 kB
                           ->  HashAggregate  (cost=858724.11..873724.11 rows=1500000 width=12) (actual time=24608.873..29810.072 rows=1501094 loops=1)
                                 Group Key: customer.c_custkey
                                 Planned Partitions: 4
                                 Peak Memory Usage: 0 kB
                                 ->  Hash Right Join  (cost=42638.00..784487.06 rows=14847409 width=12) (actual time=877.895..16684.868 rows=15350270 loops=1)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       Extra Text: (seg2)   Initial batch 0:
 (seg2)     Wrote 17601K bytes to inner workfile.
 (seg2)     Wrote 231985K bytes to outer workfile.
 (seg2)   Initial batch 1:
 (seg2)     Read 17601K bytes from inner workfile.
 (seg2)     Read 231985K bytes from outer workfile.
 (seg2)   Hash chain length 1.9 avg, 11 max, using 798283 of 1048576 buckets.
                                       ->  Redistribute Motion 3:3  (slice3; segments: 3)  (cost=0.00..550946.60 rows=14847409 width=12) (actual time=0.052..4942.550 rows=14849651 loops=1)
                                             Hash Key: orders.o_custkey
                                             ->  Seq Scan on orders  (cost=0.00..253998.42 rows=14847409 width=12) (actual time=0.106..9293.454 rows=14842004 loops=1)
                                                   Filter: ((o_comment)::text !~~ '%express%accounts%'::text)
                                                   Rows Removed by Filter: 161287
                                       ->  Hash  (cost=23888.00..23888.00 rows=1500000 width=4) (actual time=875.398..875.399 rows=1501094 loops=1)
                                             Buckets: 524288  Batches: 2  Memory Usage: 30496kB
                                             ->  Seq Scan on customer  (cost=0.00..23888.00 rows=1500000 width=4) (actual time=0.084..440.809 rows=1501094 loops=1)
 Optimizer: Postgres query optimizer
 Planning Time: 3.276 ms
   (slice0)    Executor memory: 24726K bytes.
   (slice1)    Executor memory: 61K bytes avg x 3 workers, 61K bytes max (seg0).  Work_mem: 59K bytes max.
 * (slice2)    Executor memory: 74762K bytes avg x 3 workers, 74768K bytes max (seg0).  Work_mem: 65681K bytes max, 56869K bytes wanted.
   (slice3)    Executor memory: 38K bytes avg x 3 workers, 38K bytes max (seg0).
 Memory used:  128000kB
 Memory wanted:  284944kB
 Execution Time: 30348.293 ms
(44 rows)

