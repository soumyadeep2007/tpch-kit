                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Gather Motion 3:1  (slice1; segments: 3)  (cost=406731.30..406731.61 rows=22 width=193) (actual time=10904.915..10921.410 rows=14088 loops=1)
   Merge Key: supplier.s_acctbal, nation.n_name, supplier.s_name, part.p_partkey
   ->  Sort  (cost=406731.30..406731.32 rows=7 width=193) (actual time=10799.322..10801.121 rows=4730 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method:  quicksort  Memory: 4485kB
         Executor Memory: 4179kB  Segments: 3  Max: 1403kB (segment 0)
         ->  Hash Join  (cost=373614.62..406731.20 rows=7 width=193) (actual time=8694.116..10794.306 rows=4730 loops=1)
               Hash Cond: ((partsupp_1.ps_partkey = part.p_partkey) AND ((min(partsupp_1.ps_supplycost)) = partsupp.ps_supplycost))
               Extra Text: (seg0)   Hash chain length 1.2 avg, 4 max, using 5335 of 16384 buckets.
               ->  HashAggregate  (cost=211767.75..223810.12 rows=1204237 width=36) (actual time=5089.999..6910.186 rows=1182996 loops=1)
                     Group Key: partsupp_1.ps_partkey
                     Planned Partitions: 8
                     Peak Memory Usage: 0 kB
                     ->  Redistribute Motion 3:3  (slice2; segments: 3)  (cost=3677.30..203939.69 rows=1565612 width=10) (actual time=0.054..4354.286 rows=1604737 loops=1)
                           Hash Key: partsupp_1.ps_partkey
                           ->  Hash Join  (cost=3677.30..172627.45 rows=1565612 width=10) (actual time=90.330..4380.109 rows=1605731 loops=1)
                                 Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                                 Extra Text: (seg1)   Hash chain length 1.5 avg, 6 max, using 39415 of 65536 buckets.
                                 ->  Seq Scan on partsupp partsupp_1  (cost=0.00..123297.29 rows=7999129 width=14) (actual time=0.043..1882.478 rows=8004645 loops=1)
                                 ->  Hash  (cost=2927.30..2927.30 rows=60000 width=4) (actual time=90.402..90.402 rows=60128 loops=1)
                                       Buckets: 65536  Batches: 1  Memory Usage: 2626kB
                                       ->  Broadcast Motion 3:3  (slice3; segments: 3)  (cost=2.30..2927.30 rows=60000 width=4) (actual time=3.835..74.032 rows=60128 loops=1)
                                             ->  Hash Join  (cost=2.30..2127.30 rows=20000 width=4) (actual time=3.953..79.578 rows=20111 loops=1)
                                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                                   Extra Text: (seg2)   Hash chain length 1.0 avg, 1 max, using 5 of 65536 buckets.
                                                   ->  Seq Scan on supplier supplier_1  (cost=0.00..1550.00 rows=100000 width=8) (actual time=0.521..45.579 rows=100172 loops=1)
                                                   ->  Hash  (cost=2.24..2.24 rows=5 width=4) (actual time=1.291..1.291 rows=5 loops=1)
                                                         Buckets: 65536  Batches: 1  Memory Usage: 513kB
                                                         ->  Broadcast Motion 3:3  (slice4; segments: 3)  (cost=1.05..2.24 rows=5 width=4) (actual time=0.459..1.279 rows=5 loops=1)
                                                               ->  Hash Join  (cost=1.05..2.18 rows=2 width=4) (actual time=1.454..1.739 rows=3 loops=1)
                                                                     Hash Cond: (nation_1.n_regionkey = region_1.r_regionkey)
                                                                     Extra Text: (seg0)   Hash chain length 1.0 avg, 1 max, using 1 of 65536 buckets.
                                                                     ->  Seq Scan on nation nation_1  (cost=0.00..1.08 rows=8 width=8) (actual time=0.312..0.315 rows=10 loops=1)
                                                                     ->  Hash  (cost=1.04..1.04 rows=1 width=4) (actual time=0.017..0.017 rows=1 loops=1)
                                                                           Buckets: 65536  Batches: 1  Memory Usage: 513kB
                                                                           ->  Broadcast Motion 3:3  (slice5; segments: 3)  (cost=0.00..1.04 rows=1 width=4) (actual time=0.005..0.007 rows=1 loops=1)
                                                                                 ->  Seq Scan on region region_1  (cost=0.00..1.02 rows=1 width=4) (actual time=0.189..0.190 rows=1 loops=1)
                                                                                       Filter: (r_name = 'EUROPE'::bpchar)
                                                                                       Rows Removed by Filter: 2
               ->  Hash  (cost=161638.09..161638.09 rows=13918 width=203) (actual time=3602.421..3602.421 rows=6419 loops=1)
                     Buckets: 16384  Batches: 1  Memory Usage: 1630kB
                     ->  Redistribute Motion 3:3  (slice6; segments: 3)  (cost=14525.56..161638.09 rows=13918 width=203) (actual time=151.759..3596.793 rows=6419 loops=1)
                           Hash Key: part.p_partkey
                           ->  Hash Join  (cost=14525.56..161359.73 rows=13918 width=203) (actual time=111.879..3598.435 rows=6449 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 Extra Text: (seg2)   Hash chain length 1.7 avg, 8 max, using 11580 of 16384 buckets.
                                 ->  Redistribute Motion 3:3  (slice7; segments: 3)  (cost=12148.25..158576.58 rows=71111 width=44) (actual time=23.316..3489.118 rows=32130 loops=1)
                                       Hash Key: partsupp.ps_suppkey
                                       ->  Hash Join  (cost=12148.25..157154.37 rows=71111 width=44) (actual time=64.439..3577.749 rows=31974 loops=1)
                                             Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                             Extra Text: (seg0)   Hash chain length 1.2 avg, 5 max, using 20104 of 65536 buckets.
                                             ->  Seq Scan on partsupp  (cost=0.00..123297.29 rows=7999129 width=14) (actual time=0.604..2216.217 rows=8004645 loops=1)
                                             ->  Hash  (cost=11481.52..11481.52 rows=53339 width=30) (actual time=63.214..63.214 rows=23957 loops=1)
                                                   Buckets: 65536  Batches: 1  Memory Usage: 1963kB
                                                   ->  Broadcast Motion 3:3  (slice8; segments: 3)  (cost=16.60..11481.52 rows=53339 width=30) (actual time=3.866..56.236 rows=23957 loops=1)
                                                         ->  Bitmap Heap Scan on part  (cost=16.60..10770.34 rows=17780 width=30) (actual time=2.618..55.445 rows=8102 loops=1)
                                                               Recheck Cond: (p_size = 1)
                                                               Rows Removed by Index Recheck: 4337
                                                               Filter: ((p_type)::text ~~ '%NICKEL'::text)
                                                               Rows Removed by Filter: 31674
                                                               ->  Bitmap Index Scan on part_p_size_idx  (cost=0.00..12.15 rows=39916 width=0) (actual time=1.701..1.702 rows=2240 loops=1)
                                                                     Index Cond: (p_size = 1)
                                 ->  Hash  (cost=2127.30..2127.30 rows=20000 width=167) (actual time=91.081..91.083 rows=20111 loops=1)
                                       Buckets: 16384  Batches: 1  Memory Usage: 4094kB
                                       ->  Hash Join  (cost=2.30..2127.30 rows=20000 width=167) (actual time=2.768..78.064 rows=20111 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             Extra Text: (seg2)   Hash chain length 1.0 avg, 1 max, using 5 of 65536 buckets.
                                             ->  Seq Scan on supplier  (cost=0.00..1550.00 rows=100000 width=145) (actual time=0.539..43.768 rows=100172 loops=1)
                                             ->  Hash  (cost=2.24..2.24 rows=5 width=30) (actual time=0.734..0.735 rows=5 loops=1)
                                                   Buckets: 65536  Batches: 1  Memory Usage: 513kB
                                                   ->  Broadcast Motion 3:3  (slice9; segments: 3)  (cost=1.05..2.24 rows=5 width=30) (actual time=0.452..0.724 rows=5 loops=1)
                                                         ->  Hash Join  (cost=1.05..2.18 rows=2 width=30) (actual time=1.426..1.695 rows=3 loops=1)
                                                               Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                               Extra Text: (seg0)   Hash chain length 1.0 avg, 1 max, using 1 of 65536 buckets.
                                                               ->  Seq Scan on nation  (cost=0.00..1.08 rows=8 width=34) (actual time=0.034..0.037 rows=10 loops=1)
                                                               ->  Hash  (cost=1.04..1.04 rows=1 width=4) (actual time=0.645..0.645 rows=1 loops=1)
                                                                     Buckets: 65536  Batches: 1  Memory Usage: 513kB
                                                                     ->  Broadcast Motion 3:3  (slice10; segments: 3)  (cost=0.00..1.04 rows=1 width=4) (actual time=0.004..0.638 rows=1 loops=1)
                                                                           ->  Seq Scan on region  (cost=0.00..1.02 rows=1 width=4) (actual time=0.665..0.666 rows=1 loops=1)
                                                                                 Filter: (r_name = 'EUROPE'::bpchar)
                                                                                 Rows Removed by Filter: 2
 Optimizer: Postgres query optimizer
 Planning Time: 22.307 ms
   (slice0)    Executor memory: 6390K bytes.
   (slice1)    Executor memory: 11841K bytes avg x 3 workers, 11873K bytes max (seg1).  Work_mem: 22833K bytes max.
   (slice2)    Executor memory: 2921K bytes avg x 3 workers, 2921K bytes max (seg0).  Work_mem: 2626K bytes max.
   (slice3)    Executor memory: 575K bytes avg x 3 workers, 575K bytes max (seg0).  Work_mem: 513K bytes max.
   (slice4)    Executor memory: 574K bytes avg x 3 workers, 574K bytes max (seg0).  Work_mem: 513K bytes max.
   (slice5)    Executor memory: 39K bytes avg x 3 workers, 39K bytes max (seg0).
   (slice6)    Executor memory: 4773K bytes avg x 3 workers, 4783K bytes max (seg0).  Work_mem: 4094K bytes max.
   (slice7)    Executor memory: 2055K bytes avg x 3 workers, 2055K bytes max (seg0).  Work_mem: 1963K bytes max.
   (slice8)    Executor memory: 5929K bytes avg x 3 workers, 5929K bytes max (seg0).
   (slice9)    Executor memory: 574K bytes avg x 3 workers, 574K bytes max (seg0).  Work_mem: 513K bytes max.
   (slice10)   Executor memory: 39K bytes avg x 3 workers, 39K bytes max (seg0).
 Memory used:  128000kB
 Execution Time: 10952.541 ms
(96 rows)

