                                                                                                        QUERY PLAN                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Gather Motion 3:1  (slice1; segments: 3)  (cost=1169947.52..1169947.59 rows=5 width=24) (actual time=67630.999..67631.004 rows=5 loops=1)
   Merge Key: orders.o_orderpriority
   ->  Sort  (cost=1169947.52..1169947.52 rows=2 width=24) (actual time=67624.745..67624.763 rows=2 loops=1)
         Sort Key: orders.o_orderpriority
         Sort Method:  quicksort  Memory: 75kB
         Executor Memory: 177kB  Segments: 3  Max: 59kB (segment 0)
         ->  Finalize HashAggregate  (cost=1169947.49..1169947.51 rows=2 width=24) (actual time=67624.643..67624.644 rows=2 loops=1)
               Group Key: orders.o_orderpriority
               Peak Memory Usage: 0 kB
               ->  Redistribute Motion 3:3  (slice2; segments: 3)  (cost=1169947.31..1169947.46 rows=5 width=24) (actual time=67622.321..67624.602 rows=6 loops=1)
                     Hash Key: orders.o_orderpriority
                     ->  Partial HashAggregate  (cost=1169947.31..1169947.36 rows=5 width=24) (actual time=67622.218..67622.221 rows=5 loops=1)
                           Group Key: orders.o_orderpriority
                           Peak Memory Usage: 0 kB
                           ->  Result  (cost=1165600.04..1167773.68 rows=434728 width=16) (actual time=66799.121..67419.015 rows=520631 loops=1)
                                 ->  Unique  (cost=1165600.04..1167773.68 rows=434728 width=16) (actual time=66799.120..67348.099 rows=520631 loops=1)
                                       Group Key: (RowIdExpr)
                                       ->  Sort  (cost=1165600.04..1166686.86 rows=434728 width=16) (actual time=66799.118..67083.055 rows=1434616 loops=1)
                                             Sort Key: (RowIdExpr)
                                             Sort Method:  external merge  Disk: 143136kB
                                             Executor Memory: 127245kB  Segments: 3  Max: 42415kB (segment 0)
                                             ->  Redistribute Motion 3:3  (slice3; segments: 3)  (cost=450262.02..1124888.33 rows=434728 width=16) (actual time=40507.215..65839.664 rows=1434616 loops=1)
                                                   Hash Key: (RowIdExpr)
                                                   ->  Hash Join  (cost=450262.02..1116193.78 rows=434728 width=16) (actual time=40245.197..65640.064 rows=1434573 loops=1)
                                                         Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                                         Extra Text: (seg0)   Initial batch 0:
 (seg0)     Wrote 64737K bytes to inner workfile.
 (seg0)     Wrote 777778K bytes to outer workfile.
 (seg0)   Initial batches 1..3:
 (seg0)     Read 64737K bytes from inner workfile: 21579K avg x 3 nonempty batches, 21598K max.
 (seg0)     Read 777778K bytes from outer workfile: 259260K avg x 3 nonempty batches, 259298K max.
 (seg0)   Hash chain length 2.0 avg, 13 max, using 841284 of 1048576 buckets.
                                                         ->  Bitmap Heap Scan on lineitem  (cost=326123.24..862307.37 rows=19999291 width=8) (actual time=3109.684..44109.418 rows=37938467 loops=1)
                                                               Recheck Cond: (l_commitdate < l_receiptdate)
                                                               Rows Removed by Index Recheck: 7181118
                                                               ->  Bitmap Index Scan on lineitem_l_orderkey_idx_part1  (cost=0.00..321123.42 rows=19999291 width=0) (actual time=3108.100..3108.101 rows=37938467 loops=1)
                                                         ->  Hash  (cost=99302.16..99302.16 rows=1778450 width=24) (actual time=902.140..902.140 rows=1701175 loops=1)
                                                               Buckets: 262144  Batches: 4  Memory Usage: 28696kB
                                                               ->  Broadcast Motion 3:3  (slice4; segments: 3)  (cost=166.18..99302.16 rows=1778450 width=24) (actual time=4.376..517.462 rows=1701175 loops=1)
                                                                     ->  Bitmap Heap Scan on orders  (cost=166.18..75589.50 rows=592817 width=24) (actual time=4.846..456.979 rows=567512 loops=1)
                                                                           Recheck Cond: ((o_orderdate >= '1996-09-01'::date) AND (o_orderdate < '1996-12-01 00:00:00'::timestamp without time zone))
                                                                           Rows Removed by Index Recheck: 2670
                                                                           ->  Bitmap Index Scan on orders_o_orderdate_idx  (cost=0.00..17.98 rows=594088 width=0) (actual time=2.836..2.836 rows=25600 loops=1)
                                                                                 Index Cond: ((o_orderdate >= '1996-09-01'::date) AND (o_orderdate < '1996-12-01 00:00:00'::timestamp without time zone))
 Optimizer: Postgres query optimizer
 Planning Time: 9.342 ms
   (slice0)    Executor memory: 139K bytes.
   (slice1)    Executor memory: 59K bytes avg x 3 workers, 59K bytes max (seg0).  Work_mem: 59K bytes max.
 * (slice2)    Executor memory: 42470K bytes avg x 3 workers, 42470K bytes max (seg0).  Work_mem: 42415K bytes max, 172440K bytes wanted.
 * (slice3)    Executor memory: 3603862K bytes avg x 3 workers, 3603952K bytes max (seg1).  Work_mem: 28696K bytes max, 108372K bytes wanted.
   (slice4)    Executor memory: 43170K bytes avg x 3 workers, 43340K bytes max (seg1).
 Memory used:  128000kB
 Memory wanted:  1207979kB
 Execution Time: 67660.912 ms
(54 rows)

