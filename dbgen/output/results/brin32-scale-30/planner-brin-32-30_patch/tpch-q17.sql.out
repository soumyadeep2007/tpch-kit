                                                                                                  QUERY PLAN                                                                                                  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=2934976.10..2934976.11 rows=1 width=32) (actual time=159699.907..159699.909 rows=1 loops=1)
   ->  Gather Motion 3:1  (slice1; segments: 3)  (cost=2934976.03..2934976.08 rows=3 width=32) (actual time=159655.869..159699.886 rows=3 loops=1)
         ->  Partial Aggregate  (cost=2934976.03..2934976.04 rows=1 width=32) (actual time=159696.116..159696.118 rows=1 loops=1)
               ->  Hash Join  (cost=1887515.30..2934732.97 rows=97221 width=8) (actual time=140090.669..159693.195 rows=5350 loops=1)
                     Hash Cond: (lineitem.l_partkey = part.p_partkey)
                     Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
                     Rows Removed by Join Filter: 54109
                     Extra Text: (seg0)   Hash chain length 1.0 avg, 3 max, using 5644 of 65536 buckets.
                     ->  Seq Scan on lineitem  (cost=0.00..886171.72 rows=59997872 width=17) (actual time=0.173..11059.185 rows=60003310 loops=1)
                     ->  Hash  (cost=1887150.71..1887150.71 rows=29167 width=40) (actual time=140087.194..140087.194 rows=5910 loops=1)
                           Buckets: 65536  Batches: 1  Memory Usage: 826kB
                           ->  Broadcast Motion 3:3  (slice2; segments: 3)  (cost=1824423.61..1887150.71 rows=29167 width=40) (actual time=130281.956..140085.609 rows=5910 loops=1)
                                 ->  Hash Join  (cost=1824423.61..1886761.82 rows=9722 width=40) (actual time=129398.864..140037.970 rows=2006 loops=1)
                                       Hash Cond: (lineitem_1.l_partkey = part.p_partkey)
                                       Extra Text: (seg0)   Hash chain length 1.0 avg, 2 max, using 1956 of 131072 buckets.
                                       ->  Finalize HashAggregate  (cost=1818981.15..1857754.69 rows=1858807 width=36) (actual time=129307.028..139589.061 rows=2001127 loops=1)
                                             Group Key: lineitem_1.l_partkey
                                             Planned Partitions: 8
                                             Peak Memory Usage: 0 kB
                                             ->  Redistribute Motion 3:3  (slice3; segments: 3)  (cost=1479119.44..1733592.37 rows=5576410 width=36) (actual time=52438.051..122920.751 rows=6003137 loops=1)
                                                   Hash Key: lineitem_1.l_partkey
                                                   ->  Partial HashAggregate  (cost=1479119.44..1622064.16 rows=5576410 width=36) (actual time=52637.789..126875.048 rows=5999772 loops=1)
                                                         Group Key: lineitem_1.l_partkey
                                                         Planned Partitions: 32
                                                         Peak Memory Usage: 0 kB
                                                         ->  Seq Scan on lineitem lineitem_1  (cost=0.00..886171.72 rows=59997872 width=9) (actual time=0.077..11518.794 rows=60003310 loops=1)
                                       ->  Hash  (cost=5311.70..5311.70 rows=10461 width=4) (actual time=79.032..79.033 rows=2006 loops=1)
                                             Buckets: 131072  Batches: 1  Memory Usage: 1095kB
                                             ->  Bitmap Heap Scan on part  (cost=102.41..5311.70 rows=10461 width=4) (actual time=20.554..78.025 rows=2006 loops=1)
                                                   Recheck Cond: ((p_container = 'SM BOX'::bpchar) AND (p_brand = 'Brand#53'::bpchar))
                                                   ->  Bitmap Index Scan on part_p_container_p_brand_p_partkey_idx  (cost=0.00..99.80 rows=2121 width=0) (actual time=20.203..20.204 rows=2006 loops=1)
                                                         Index Cond: ((p_container = 'SM BOX'::bpchar) AND (p_brand = 'Brand#53'::bpchar))
 Optimizer: Postgres query optimizer
 Planning Time: 5.976 ms
   (slice0)    Executor memory: 18577K bytes.
   (slice1)    Executor memory: 874K bytes avg x 3 workers, 874K bytes max (seg0).  Work_mem: 826K bytes max.
   (slice2)    Executor memory: 48245K bytes avg x 3 workers, 56445K bytes max (seg0).  Work_mem: 43281K bytes max.
   (slice3)    Executor memory: 24890K bytes avg x 3 workers, 24890K bytes max (seg0).  Work_mem: 33809K bytes max.
 Memory used:  128000kB
 Execution Time: 159715.095 ms
(40 rows)

