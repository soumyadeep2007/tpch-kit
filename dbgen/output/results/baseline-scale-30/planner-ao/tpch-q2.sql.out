                                                                                                            QUERY PLAN                                                                                                             
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Gather Motion 3:1  (slice1; segments: 3)  (cost=449218.66..449218.98 rows=22 width=192) (actual time=13720.552..13732.722 rows=14088 loops=1)
   Merge Key: supplier.s_acctbal, nation.n_name, supplier.s_name, part.p_partkey
   ->  Sort  (cost=449218.66..449218.68 rows=7 width=192) (actual time=13716.631..13718.221 rows=4730 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method:  quicksort  Memory: 4485kB
         Executor Memory: 4179kB  Segments: 3  Max: 1403kB (segment 0)
         ->  Hash Join  (cost=403265.36..449218.56 rows=7 width=192) (actual time=12032.196..13712.439 rows=4730 loops=1)
               Hash Cond: ((partsupp_1.ps_partkey = part.p_partkey) AND ((min(partsupp_1.ps_supplycost)) = partsupp.ps_supplycost))
               Extra Text: (seg0)   Hash chain length 1.2 avg, 4 max, using 5335 of 16384 buckets.
               ->  HashAggregate  (cost=216278.80..234231.93 rows=1600000 width=36) (actual time=6235.771..7600.651 rows=1182996 loops=1)
                     Group Key: partsupp_1.ps_partkey
                     Planned Partitions: 8
                     Extra Text: (seg0)   hash table(s): 1; 1181520 groups total in 8 batches, 11242096 spill partitions; disk usage: 60864KB; chain length 2.4 avg, 12 max; using 1181520 of 2359296 buckets; total 0 expansions.
 
                     ->  Redistribute Motion 3:3  (slice2; segments: 3)  (cost=3634.31..200466.30 rows=1600000 width=10) (actual time=0.090..5471.439 rows=1604737 loops=1)
                           Hash Key: partsupp_1.ps_partkey
                           ->  Hash Join  (cost=3634.31..168466.31 rows=1600000 width=10) (actual time=134.806..5336.393 rows=1605731 loops=1)
                                 Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                                 Extra Text: (seg1)   Hash chain length 1.2 avg, 5 max, using 48266 of 131072 buckets.
                                 ->  Seq Scan on partsupp partsupp_1  (cost=0.00..118832.00 rows=8000000 width=14) (actual time=4.146..3268.091 rows=8004645 loops=1)
                                 ->  Hash  (cost=2884.31..2884.31 rows=60000 width=4) (actual time=127.442..127.443 rows=60128 loops=1)
                                       Buckets: 131072  Batches: 1  Memory Usage: 3138kB
                                       ->  Broadcast Motion 3:3  (slice3; segments: 3)  (cost=2.31..2884.31 rows=60000 width=4) (actual time=9.463..109.467 rows=60128 loops=1)
                                             ->  Hash Join  (cost=2.31..2084.31 rows=20000 width=4) (actual time=6.056..93.330 rows=20111 loops=1)
                                                   Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                                   Extra Text: (seg2)   Hash chain length 1.0 avg, 1 max, using 5 of 65536 buckets.
                                                   ->  Seq Scan on supplier supplier_1  (cost=0.00..1507.00 rows=100000 width=8) (actual time=2.839..68.334 rows=100172 loops=1)
                                                   ->  Hash  (cost=2.24..2.24 rows=5 width=4) (actual time=3.018..3.019 rows=5 loops=1)
                                                         Buckets: 65536  Batches: 1  Memory Usage: 513kB
                                                         ->  Broadcast Motion 3:3  (slice4; segments: 3)  (cost=1.05..2.24 rows=5 width=4) (actual time=2.798..2.997 rows=5 loops=1)
                                                               ->  Hash Join  (cost=1.05..2.18 rows=2 width=4) (actual time=1.346..1.612 rows=3 loops=1)
                                                                     Hash Cond: (nation_1.n_regionkey = region_1.r_regionkey)
                                                                     Extra Text: (seg0)   Hash chain length 1.0 avg, 1 max, using 1 of 65536 buckets.
                                                                     ->  Seq Scan on nation nation_1  (cost=0.00..1.08 rows=8 width=8) (actual time=0.505..0.511 rows=10 loops=1)
                                                                     ->  Hash  (cost=1.04..1.04 rows=1 width=4) (actual time=0.016..0.016 rows=1 loops=1)
                                                                           Buckets: 65536  Batches: 1  Memory Usage: 513kB
                                                                           ->  Broadcast Motion 3:3  (slice5; segments: 3)  (cost=0.00..1.04 rows=1 width=4) (actual time=0.007..0.009 rows=1 loops=1)
                                                                                 ->  Seq Scan on region region_1  (cost=0.00..1.02 rows=1 width=4) (actual time=0.643..0.648 rows=1 loops=1)
                                                                                       Filter: (r_name = 'EUROPE'::bpchar)
                                                                                       Rows Removed by Filter: 2
               ->  Hash  (cost=186781.73..186781.73 rows=13655 width=202) (actual time=5796.008..5796.009 rows=6419 loops=1)
                     Buckets: 16384  Batches: 1  Memory Usage: 1630kB
                     ->  Redistribute Motion 3:3  (slice6; segments: 3)  (cost=43210.16..186781.73 rows=13655 width=202) (actual time=1397.836..5790.710 rows=6419 loops=1)
                           Hash Key: part.p_partkey
                           ->  Hash Join  (cost=43210.16..186508.62 rows=13655 width=202) (actual time=1339.581..5787.398 rows=6449 loops=1)
                                 Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                 Extra Text: (seg2)   Hash chain length 1.7 avg, 8 max, using 11580 of 16384 buckets.
                                 ->  Redistribute Motion 3:3  (slice7; segments: 3)  (cost=40875.85..183781.73 rows=68276 width=44) (actual time=1206.815..5636.159 rows=32130 loops=1)
                                       Hash Key: partsupp.ps_suppkey
                                       ->  Hash Join  (cost=40875.85..182416.20 rows=68276 width=44) (actual time=1271.986..5772.344 rows=31974 loops=1)
                                             Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                             Extra Text: (seg0)   Hash chain length 1.2 avg, 5 max, using 20104 of 65536 buckets.
                                             ->  Seq Scan on partsupp  (cost=0.00..118832.00 rows=8000000 width=14) (actual time=0.455..3337.055 rows=8004645 loops=1)
                                             ->  Hash  (cost=40235.76..40235.76 rows=51207 width=30) (actual time=1270.034..1270.034 rows=23957 loops=1)
                                                   Buckets: 65536  Batches: 1  Memory Usage: 1963kB
                                                   ->  Broadcast Motion 3:3  (slice8; segments: 3)  (cost=0.00..40235.76 rows=51207 width=30) (actual time=1.707..1263.085 rows=23957 loops=1)
                                                         ->  Seq Scan on part  (cost=0.00..39553.00 rows=17069 width=30) (actual time=2.320..1231.790 rows=8102 loops=1)
                                                               Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 1))
                                                               Rows Removed by Filter: 1991337
                                 ->  Hash  (cost=2084.31..2084.31 rows=20000 width=166) (actual time=103.524..103.527 rows=20111 loops=1)
                                       Buckets: 16384  Batches: 1  Memory Usage: 4094kB
                                       ->  Hash Join  (cost=2.31..2084.31 rows=20000 width=166) (actual time=4.946..91.704 rows=20111 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             Extra Text: (seg2)   Hash chain length 1.0 avg, 1 max, using 5 of 65536 buckets.
                                             ->  Seq Scan on supplier  (cost=0.00..1507.00 rows=100000 width=144) (actual time=3.460..68.072 rows=100172 loops=1)
                                             ->  Hash  (cost=2.24..2.24 rows=5 width=30) (actual time=3.827..3.828 rows=5 loops=1)
                                                   Buckets: 65536  Batches: 1  Memory Usage: 513kB
                                                   ->  Broadcast Motion 3:3  (slice9; segments: 3)  (cost=1.05..2.24 rows=5 width=30) (actual time=3.795..3.803 rows=5 loops=1)
                                                         ->  Hash Join  (cost=1.05..2.18 rows=2 width=30) (actual time=4.030..4.693 rows=3 loops=1)
                                                               Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                               Extra Text: (seg0)   Hash chain length 1.0 avg, 1 max, using 1 of 65536 buckets.
                                                               ->  Seq Scan on nation  (cost=0.00..1.08 rows=8 width=34) (actual time=1.254..1.263 rows=10 loops=1)
                                                               ->  Hash  (cost=1.04..1.04 rows=1 width=4) (actual time=2.008..2.010 rows=1 loops=1)
                                                                     Buckets: 65536  Batches: 1  Memory Usage: 513kB
                                                                     ->  Broadcast Motion 3:3  (slice10; segments: 3)  (cost=0.00..1.04 rows=1 width=4) (actual time=1.998..2.000 rows=1 loops=1)
                                                                           ->  Seq Scan on region  (cost=0.00..1.02 rows=1 width=4) (actual time=2.067..2.072 rows=1 loops=1)
                                                                                 Filter: (r_name = 'EUROPE'::bpchar)
                                                                                 Rows Removed by Filter: 2
 Optimizer: Postgres-based planner
 Planning Time: 5.574 ms
   (slice0)    Executor memory: 6381K bytes.
 * (slice1)    Executor memory: 16421K bytes avg x 3 workers, 16433K bytes max (seg1).  Work_mem: 26897K bytes max, 174097K bytes wanted.
   (slice2)    Executor memory: 3610K bytes avg x 3 workers, 3610K bytes max (seg0).  Work_mem: 3138K bytes max.
   (slice3)    Executor memory: 751K bytes avg x 3 workers, 751K bytes max (seg0).  Work_mem: 513K bytes max.
   (slice4)    Executor memory: 739K bytes avg x 3 workers, 739K bytes max (seg0).  Work_mem: 513K bytes max.
   (slice5)    Executor memory: 183K bytes avg x 3 workers, 185K bytes max (seg0).
   (slice6)    Executor memory: 4917K bytes avg x 3 workers, 4928K bytes max (seg0).  Work_mem: 4094K bytes max.
   (slice7)    Executor memory: 2232K bytes avg x 3 workers, 2232K bytes max (seg0).  Work_mem: 1963K bytes max.
   (slice8)    Executor memory: 199K bytes avg x 3 workers, 199K bytes max (seg0).
   (slice9)    Executor memory: 740K bytes avg x 3 workers, 740K bytes max (seg0).  Work_mem: 513K bytes max.
   (slice10)   Executor memory: 183K bytes avg x 3 workers, 185K bytes max (seg0).
 Memory used:  128000kB
 Memory wanted:  1743660kB
 Execution Time: 13764.447 ms
(94 rows)

