                                                                                                                  QUERY PLAN                                                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Gather Motion 3:1  (slice1; segments: 3)  (cost=1037004.45..1037018.61 rows=1000 width=16) (actual time=33106.060..33106.072 rows=45 loops=1)
   Merge Key: (count(*)), (count(orders.o_orderkey))
   ->  Sort  (cost=1037004.45..1037005.28 rows=333 width=16) (actual time=33105.075..33105.081 rows=17 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method:  quicksort  Memory: 75kB
         Executor Memory: 177kB  Segments: 3  Max: 59kB (segment 0)
         ->  Finalize HashAggregate  (cost=1036987.14..1036990.48 rows=333 width=16) (actual time=33104.979..33104.988 rows=17 loops=1)
               Group Key: (count(orders.o_orderkey))
               Extra Text: (seg0)   hash table(s): 1; chain length 1.0 avg, 1 max; using 17 of 512 buckets; total 0 expansions.
 
               ->  Redistribute Motion 3:3  (slice2; segments: 3)  (cost=1036952.14..1036982.14 rows=1000 width=16) (actual time=33034.156..33104.932 rows=51 loops=1)
                     Hash Key: (count(orders.o_orderkey))
                     ->  Partial HashAggregate  (cost=1036952.14..1036962.14 rows=1000 width=16) (actual time=33100.854..33100.871 rows=45 loops=1)
                           Group Key: count(orders.o_orderkey)
                           Extra Text: (seg0)   hash table(s): 1; chain length 1.0 avg, 1 max; using 44 of 2048 buckets; total 0 expansions.
 
                           ->  HashAggregate  (cost=981143.43..1014452.14 rows=1500000 width=12) (actual time=26802.227..32736.024 rows=1501094 loops=1)
                                 Group Key: customer.c_custkey
                                 Planned Partitions: 8
                                 Extra Text: (seg0)   hash table(s): 1; 1499205 groups total in 8 batches, 96084232 spill partitions; disk usage: 422688KB; chain length 2.2 avg, 7 max; using 1499205 of 4718592 buckets; total 0 expansions.
 
                                 ->  Hash Right Join  (cost=42090.00..832916.07 rows=14998500 width=12) (actual time=1118.090..19316.719 rows=15350270 loops=1)
                                       Hash Cond: (orders.o_custkey = customer.c_custkey)
                                       Extra Text: (seg2)   Initial batch 0:
 (seg2)     Wrote 17601K bytes to inner workfile.
 (seg2)     Wrote 231985K bytes to outer workfile.
 (seg2)   Initial batch 1:
 (seg2)     Read 17601K bytes from inner workfile.
 (seg2)     Read 231985K bytes from outer workfile.
 (seg2)   Work file set: 1 files (0 compressed), max file size 18022400, min file size 32768, compression buffer size 0 bytes
 (seg2)   Hash chain length 1.9 avg, 11 max, using 798283 of 1048576 buckets.
                                       ->  Redistribute Motion 3:3  (slice3; segments: 3)  (cost=0.00..549706.00 rows=14998500 width=12) (actual time=0.056..6328.673 rows=14849651 loops=1)
                                             Hash Key: orders.o_custkey
                                             ->  Seq Scan on orders  (cost=0.00..249736.00 rows=14998500 width=12) (actual time=0.450..11827.292 rows=14842004 loops=1)
                                                   Filter: ((o_comment)::text !~~ '%express%accounts%'::text)
                                                   Rows Removed by Filter: 161287
                                       ->  Hash  (cost=23340.00..23340.00 rows=1500000 width=4) (actual time=1116.634..1116.635 rows=1501094 loops=1)
                                             Buckets: 524288  Batches: 2  Memory Usage: 30496kB
                                             ->  Seq Scan on customer  (cost=0.00..23340.00 rows=1500000 width=4) (actual time=0.481..702.510 rows=1501094 loops=1)
 Optimizer: Postgres-based planner
 Planning Time: 1.832 ms
   (slice0)    Executor memory: 12439K bytes.
 * (slice1)    Executor memory: 61K bytes avg x 3 workers, 61K bytes max (seg0).  Work_mem: 59K bytes max, 37K bytes wanted.
 * (slice2)    Executor memory: 55582K bytes avg x 3 workers, 55588K bytes max (seg0).  Work_mem: 33041K bytes max, 163857K bytes wanted.
   (slice3)    Executor memory: 199K bytes avg x 3 workers, 199K bytes max (seg0).
 Memory used:  128000kB
 Memory wanted:  819880kB
 Execution Time: 33157.625 ms
(48 rows)

