                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Gather Motion 3:1  (slice1; segments: 3)  (cost=182606.40..187139.73 rows=320000 width=36) (actual time=4978.806..4998.743 rows=30005 loops=1)
   Merge Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)))
   InitPlan 1 (returns $0)  (slice5)
     ->  Finalize Aggregate  (cost=156545.21..156545.22 rows=1 width=32) (actual time=4234.684..4234.685 rows=1 loops=1)
           ->  Gather Motion 3:1  (slice6; segments: 3)  (cost=156545.14..156545.19 rows=3 width=32) (actual time=4223.896..4234.656 rows=3 loops=1)
                 ->  Partial Aggregate  (cost=156545.14..156545.15 rows=1 width=32) (actual time=4233.129..4233.130 rows=1 loops=1)
                       ->  Hash Join  (cost=2113.14..154145.14 rows=320000 width=10) (actual time=64.804..4046.600 rows=317137 loops=1)
                             Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                             Extra Text: (seg1)   Hash chain length 1.0 avg, 3 max, using 11342 of 131072 buckets.
                             ->  Seq Scan on partsupp partsupp_1  (cost=0.00..118832.00 rows=8000000 width=14) (actual time=0.714..2920.989 rows=8004645 loops=1)
                             ->  Hash  (cost=1963.14..1963.14 rows=12000 width=4) (actual time=63.439..63.439 rows=11857 loops=1)
                                   Buckets: 131072  Batches: 1  Memory Usage: 1441kB
                                   ->  Broadcast Motion 3:3  (slice7; segments: 3)  (cost=1.14..1963.14 rows=12000 width=4) (actual time=7.778..60.315 rows=11857 loops=1)
                                         ->  Hash Join  (cost=1.14..1803.14 rows=4000 width=4) (actual time=1.188..58.012 rows=4019 loops=1)
                                               Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                               Extra Text: (seg1)   Hash chain length 1.0 avg, 1 max, using 1 of 131072 buckets.
                                               ->  Seq Scan on supplier supplier_1  (cost=0.00..1507.00 rows=100000 width=8) (actual time=0.405..45.882 rows=100172 loops=1)
                                               ->  Hash  (cost=1.12..1.12 rows=1 width=4) (actual time=0.540..0.540 rows=1 loops=1)
                                                     Buckets: 131072  Batches: 1  Memory Usage: 1025kB
                                                     ->  Broadcast Motion 3:3  (slice8; segments: 3)  (cost=0.00..1.12 rows=1 width=4) (actual time=0.532..0.532 rows=1 loops=1)
                                                           ->  Seq Scan on nation nation_1  (cost=0.00..1.10 rows=1 width=4) (actual time=0.446..0.464 rows=1 loops=1)
                                                                 Filter: (n_name = 'JORDAN'::bpchar)
                                                                 Rows Removed by Filter: 8
   ->  Sort  (cost=182606.40..182873.06 rows=106667 width=36) (actual time=4973.574..4974.921 rows=10066 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method:  quicksort  Memory: 2794kB
         Executor Memory: 2101kB  Segments: 3  Max: 703kB (segment 0)
         ->  HashAggregate  (cost=167707.64..173698.26 rows=106667 width=36) (actual time=4481.182..4968.630 rows=10066 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $0)
               Rows Removed by Filter: 288197
               Extra Text: (seg0)   hash table(s): 1; 298263 groups total in 4 batches, 940288 spill partitions; disk usage: 13600KB; chain length 2.1 avg, 6 max; using 298263 of 1310720 buckets; total 0 expansions.
 
               ->  Redistribute Motion 3:3  (slice2; segments: 3)  (cost=2113.14..160545.14 rows=320000 width=14) (actual time=71.095..4197.632 rows=316478 loops=1)
                     Hash Key: partsupp.ps_partkey
                     ->  Hash Join  (cost=2113.14..154145.14 rows=320000 width=14) (actual time=60.063..4139.314 rows=317137 loops=1)
                           Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                           Extra Text: (seg1)   Hash chain length 1.0 avg, 3 max, using 11342 of 131072 buckets.
                           ->  Seq Scan on partsupp  (cost=0.00..118832.00 rows=8000000 width=18) (actual time=0.323..3001.084 rows=8004645 loops=1)
                           ->  Hash  (cost=1963.14..1963.14 rows=12000 width=4) (actual time=59.337..59.338 rows=11857 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 1441kB
                                 ->  Broadcast Motion 3:3  (slice3; segments: 3)  (cost=1.14..1963.14 rows=12000 width=4) (actual time=7.086..56.855 rows=11857 loops=1)
                                       ->  Hash Join  (cost=1.14..1803.14 rows=4000 width=4) (actual time=1.329..57.149 rows=4019 loops=1)
                                             Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                             Extra Text: (seg1)   Hash chain length 1.0 avg, 1 max, using 1 of 131072 buckets.
                                             ->  Seq Scan on supplier  (cost=0.00..1507.00 rows=100000 width=8) (actual time=0.308..43.421 rows=100172 loops=1)
                                             ->  Hash  (cost=1.12..1.12 rows=1 width=4) (actual time=0.008..0.008 rows=1 loops=1)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 1025kB
                                                   ->  Broadcast Motion 3:3  (slice4; segments: 3)  (cost=0.00..1.12 rows=1 width=4) (actual time=0.003..0.004 rows=1 loops=1)
                                                         ->  Seq Scan on nation  (cost=0.00..1.10 rows=1 width=4) (actual time=0.500..0.503 rows=1 loops=1)
                                                               Filter: (n_name = 'JORDAN'::bpchar)
                                                               Rows Removed by Filter: 8
 Optimizer: Postgres-based planner
 Planning Time: 2.954 ms
   (slice0)    Executor memory: 6357K bytes.
 * (slice1)    Executor memory: 21940K bytes avg x 3 workers, 21940K bytes max (seg1).  Work_mem: 32913K bytes max, 106513K bytes wanted.
   (slice2)    Executor memory: 1720K bytes avg x 3 workers, 1720K bytes max (seg0).  Work_mem: 1441K bytes max.
   (slice3)    Executor memory: 1263K bytes avg x 3 workers, 1263K bytes max (seg0).  Work_mem: 1025K bytes max.
   (slice4)    Executor memory: 185K bytes avg x 3 workers, 185K bytes max (seg0).
   (slice5)    Executor memory: 6285K bytes.
   (slice6)    Executor memory: 1718K bytes avg x 3 workers, 1718K bytes max (seg0).  Work_mem: 1441K bytes max.
   (slice7)    Executor memory: 1263K bytes avg x 3 workers, 1263K bytes max (seg0).  Work_mem: 1025K bytes max.
   (slice8)    Executor memory: 185K bytes avg x 3 workers, 185K bytes max (seg0).
 Memory used:  128000kB
 Memory wanted:  640972kB
 Execution Time: 9252.565 ms
(66 rows)

