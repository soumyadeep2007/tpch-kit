                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Gather Motion 3:1  (slice1; segments: 3)  (cost=201325.58..201325.89 rows=22 width=44) (actual time=21939.348..21961.806 rows=27840 loops=1)
   Merge Key: (count(DISTINCT partsupp.ps_suppkey)), part.p_brand, part.p_type, part.p_size
   ->  Sort  (cost=201325.58..201325.60 rows=7 width=44) (actual time=21938.234..21939.416 rows=9382 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method:  quicksort  Memory: 3570kB
         Executor Memory: 2935kB  Segments: 3  Max: 985kB (segment 0)
         ->  GroupAggregate  (cost=201325.31..201325.48 rows=7 width=44) (actual time=20798.117..21918.906 rows=9382 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Sort  (cost=201325.31..201325.33 rows=7 width=40) (actual time=20797.997..21361.995 rows=1199737 loops=1)
                     Sort Key: part.p_brand, part.p_type, part.p_size
                     Sort Method:  external merge  Disk: 181344kB
                     Executor Memory: 127643kB  Segments: 3  Max: 42548kB (segment 0)
                     ->  Redistribute Motion 3:3  (slice2; segments: 3)  (cost=140592.27..201325.21 rows=7 width=40) (actual time=9610.123..17997.854 rows=1199737 loops=1)
                           Hash Key: part.p_brand, part.p_type, part.p_size
                           ->  Hash Join  (cost=140592.27..201325.06 rows=7 width=40) (actual time=9607.941..13431.207 rows=1187209 loops=1)
                                 Hash Cond: (part.p_partkey = partsupp.ps_partkey)
                                 Extra Text: (seg2)   Initial batch 0:
 (seg2)     Wrote 191357K bytes to inner workfile.
 (seg2)     Wrote 15724K bytes to outer workfile.
 (seg2)   Overflow batches 1..7:
 (seg2)     Read 264379K bytes from inner workfile: 37769K avg x 7 nonempty batches, 69029K max.
 (seg2)     Wrote 73023K bytes to inner workfile: 24341K avg x 3 overflowing batches, 41722K max.
 (seg2)     Read 15724K bytes from outer workfile: 2247K avg x 7 nonempty batches, 2267K max.
 (seg2)   Work file set: 7 files (0 compressed), max file size 70680576, min file size 32768, compression buffer size 0 bytes
 (seg2)   Hash chain length 5.0 avg, 28 max, using 1592080 of 4194304 buckets.
                                 ->  Seq Scan on part  (cost=0.00..59553.00 rows=314591 width=40) (actual time=42.410..1113.338 rows=296961 loops=1)
                                       Filter: ((p_brand <> 'Brand#55'::bpchar) AND ((p_type)::text !~~ 'LARGE ANODIZED%'::text) AND (p_size = ANY ('{3,45,14,32,41,8,21,15}'::integer[])))
                                       Rows Removed by Filter: 1702478
                                 ->  Hash  (cost=140592.17..140592.17 rows=8 width=8) (actual time=9565.436..9565.437 rows=8000358 loops=1)
                                       Buckets: 524288 (originally 262144)  Batches: 8 (originally 1)  Memory Usage: 59755kB
                                       ->  Redistribute Motion 3:3  (slice3; segments: 3)  (cost=1757.78..140592.17 rows=8 width=8) (actual time=58.171..7694.987 rows=8000358 loops=1)
                                             Hash Key: partsupp.ps_partkey
                                             ->  Hash Left Anti Semi (Not-In) Join  (cost=1757.78..140592.01 rows=8 width=8) (actual time=57.259..6082.149 rows=8000604 loops=1)
                                                   Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                                   Extra Text: (seg1)   Hash chain length 1.0 avg, 1 max, using 155 of 262144 buckets.
                                                   ->  Seq Scan on partsupp  (cost=0.00..118832.00 rows=8000000 width=8) (actual time=0.855..3455.556 rows=8004645 loops=1)
                                                   ->  Hash  (cost=1757.40..1757.40 rows=30 width=4) (actual time=54.822..54.822 rows=155 loops=1)
                                                         Buckets: 262144  Batches: 1  Memory Usage: 2054kB
                                                         ->  Broadcast Motion 3:3  (slice4; segments: 3)  (cost=0.00..1757.40 rows=30 width=4) (actual time=53.481..54.714 rows=155 loops=1)
                                                               ->  Seq Scan on supplier  (cost=0.00..1757.00 rows=10 width=4) (actual time=1.471..55.976 rows=60 loops=1)
                                                                     Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                                                     Rows Removed by Filter: 99891
 Optimizer: Postgres-based planner
 Planning Time: 7.549 ms
   (slice0)    Executor memory: 114K bytes.
 * (slice1)    Executor memory: 43526K bytes avg x 3 workers, 43532K bytes max (seg0).  Work_mem: 42548K bytes max, 152255K bytes wanted.
 * (slice2)    Executor memory: 64126K bytes avg x 3 workers, 64128K bytes max (seg1).  Work_mem: 59755K bytes max, 316610K bytes wanted.
   (slice3)    Executor memory: 2288K bytes avg x 3 workers, 2288K bytes max (seg0).  Work_mem: 2054K bytes max.
   (slice4)    Executor memory: 197K bytes avg x 3 workers, 197K bytes max (seg0).
 Memory used:  128000kB
 Memory wanted:  1583949kB
 Execution Time: 21987.617 ms
(52 rows)

