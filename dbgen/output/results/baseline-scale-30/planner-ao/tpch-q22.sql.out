                                                                                      QUERY PLAN                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Gather Motion 3:1  (slice1; segments: 3)  (cost=776787.85..776788.42 rows=25 width=72) (actual time=17060.695..17060.701 rows=7 loops=1)
   Merge Key: ("substring"((customer.c_phone)::text, 1, 2))
   InitPlan 1 (returns $0)  (slice4)
     ->  Finalize Aggregate  (cost=47740.11..47740.12 rows=1 width=32) (actual time=1767.256..1767.256 rows=1 loops=1)
           ->  Gather Motion 3:1  (slice5; segments: 3)  (cost=47740.04..47740.09 rows=3 width=32) (actual time=1727.214..1767.217 rows=3 loops=1)
                 ->  Partial Aggregate  (cost=47740.04..47740.05 rows=1 width=32) (actual time=1725.827..1725.828 rows=1 loops=1)
                       ->  Seq Scan on customer customer_1  (cost=0.00..47715.00 rows=10015 width=6) (actual time=0.647..1637.551 rows=382728 loops=1)
                             Filter: ((c_acctbal > 0.00) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{25,30,13,20,17,19,32}'::text[])))
                             Rows Removed by Filter: 1116477
   ->  GroupAggregate  (cost=776787.85..776788.08 rows=8 width=72) (actual time=17032.601..17059.983 rows=3 loops=1)
         Group Key: ("substring"((customer.c_phone)::text, 1, 2))
         ->  Sort  (cost=776787.85..776787.87 rows=8 width=38) (actual time=17014.510..17022.855 rows=82147 loops=1)
               Sort Key: ("substring"((customer.c_phone)::text, 1, 2))
               Sort Method:  quicksort  Memory: 16625kB
               Executor Memory: 12143kB  Segments: 3  Max: 5643kB (segment 1)
               ->  Redistribute Motion 3:3  (slice2; segments: 3)  (cost=714385.00..776787.72 rows=8 width=38) (actual time=12278.275..16995.118 rows=82147 loops=1)
                     Hash Key: ("substring"((customer.c_phone)::text, 1, 2))
                     ->  Hash Anti Join  (cost=714385.00..776787.55 rows=8 width=38) (actual time=12010.541..16908.987 rows=63889 loops=1)
                           Hash Cond: (customer.c_custkey = orders.o_custkey)
                           Extra Text: (seg2)   Initial batch 0:
 (seg2)     Wrote 329888K bytes to inner workfile.
 (seg2)     Wrote 8404K bytes to outer workfile.
 (seg2)   Initial batches 1..15:
 (seg2)     Read 329888K bytes from inner workfile: 21993K avg x 15 nonempty batches, 22146K max.
 (seg2)     Read 8404K bytes from outer workfile: 561K avg x 15 nonempty batches, 571K max.
 (seg2)   Work file set: 15 files (0 compressed), max file size 22675456, min file size 32768, compression buffer size 0 bytes
 (seg2)   Hash chain length 15.9 avg, 122 max, using 943175 of 8388608 buckets.
                           ->  Seq Scan on customer  (cost=0.00..47715.00 rows=6062 width=26) (actual time=0.553..1351.068 rows=191505 loops=1)
                                 Filter: ((c_acctbal > $0) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{25,30,13,20,17,19,32}'::text[])))
                                 Rows Removed by Filter: 1307700
                           ->  Hash  (cost=512236.00..512236.00 rows=15000000 width=4) (actual time=12007.462..12007.462 rows=15011435 loops=1)
                                 Buckets: 524288  Batches: 16  Memory Usage: 37202kB
                                 ->  Redistribute Motion 3:3  (slice3; segments: 3)  (cost=0.00..512236.00 rows=15000000 width=4) (actual time=0.105..9332.700 rows=15011435 loops=1)
                                       Hash Key: orders.o_custkey
                                       ->  Seq Scan on orders  (cost=0.00..212236.00 rows=15000000 width=4) (actual time=0.453..7148.353 rows=15003291 loops=1)
 Optimizer: Postgres-based planner
 Planning Time: 3.369 ms
   (slice0)    Executor memory: 114K bytes.
   (slice1)    Executor memory: 4106K bytes avg x 3 workers, 5701K bytes max (seg1).  Work_mem: 5643K bytes max.
 * (slice2)    Executor memory: 42033K bytes avg x 3 workers, 42120K bytes max (seg0).  Work_mem: 37202K bytes max, 531842K bytes wanted.
   (slice3)    Executor memory: 198K bytes avg x 3 workers, 198K bytes max (seg0).
   (slice4)    Executor memory: 89K bytes.
   (slice5)    Executor memory: 196K bytes avg x 3 workers, 196K bytes max (seg0).
 Memory used:  128000kB
 Memory wanted:  1064783kB
 Execution Time: 18840.387 ms
(46 rows)

