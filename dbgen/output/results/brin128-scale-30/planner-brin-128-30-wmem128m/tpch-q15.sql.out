CREATE VIEW
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Gather Motion 3:1  (slice1; segments: 3)  (cost=1202098.56..1202102.87 rows=305 width=104) (actual time=6954.845..6954.849 rows=1 loops=1)
   Merge Key: supplier.s_suppkey
   InitPlan 1 (returns $0)  (slice3)
     ->  Finalize Aggregate  (cost=1199518.23..1199518.24 rows=1 width=32) (actual time=7169.961..7169.961 rows=1 loops=1)
           ->  Gather Motion 3:1  (slice4; segments: 3)  (cost=1199518.18..1199518.23 rows=3 width=32) (actual time=7153.676..7169.946 rows=3 loops=1)
                 ->  Partial Aggregate  (cost=1199518.18..1199518.19 rows=1 width=32) (actual time=7150.426..7150.427 rows=1 loops=1)
                       ->  Finalize HashAggregate  (cost=1196980.28..1198249.23 rows=101516 width=36) (actual time=6886.131..7154.327 rows=100172 loops=1)
                             Group Key: lineitem_1.l_suppkey
                             Peak Memory Usage: 0 kB
                             ->  Redistribute Motion 3:3  (slice5; segments: 3)  (cost=1184799.74..1194696.43 rows=304513 width=36) (actual time=3898.903..6492.622 rows=300379 loops=1)
                                   Hash Key: lineitem_1.l_suppkey
                                   ->  Partial HashAggregate  (cost=1184799.74..1188606.16 rows=304513 width=36) (actual time=3993.060..6684.758 rows=299862 loops=1)
                                         Group Key: lineitem_1.l_suppkey
                                         Peak Memory Usage: 0 kB
                                         ->  Bitmap Heap Scan on lineitem lineitem_1  (cost=592.46..1162067.80 rows=2273194 width=16) (actual time=15.116..1244.101 rows=2295994 loops=1)
                                               Recheck Cond: ((l_shipdate >= '1997-05-01'::date) AND (l_shipdate < '1997-08-01 00:00:00'::timestamp without time zone))
                                               Rows Removed by Index Recheck: 65292
                                               ->  Bitmap Index Scan on lineitem_l_shipdate_idx  (cost=0.00..24.16 rows=2280838 width=0) (actual time=2.446..2.447 rows=113920 loops=1)
                                                     Index Cond: ((l_shipdate >= '1997-05-01'::date) AND (l_shipdate < '1997-08-01 00:00:00'::timestamp without time zone))
   ->  Sort  (cost=1202098.56..1202098.81 rows=102 width=104) (actual time=6954.077..6954.082 rows=1 loops=1)
         Sort Key: supplier.s_suppkey
         Sort Method:  quicksort  Memory: 75kB
         Executor Memory: 177kB  Segments: 3  Max: 59kB (segment 0)
         ->  Hash Join  (cost=1200281.66..1202095.17 rows=102 width=104) (actual time=6927.064..6953.886 rows=1 loops=1)
               Hash Cond: (supplier.s_suppkey = revenue0.supplier_no)
               Extra Text: (seg0)   Hash chain length 1.0 avg, 1 max, using 1 of 65536 buckets.
               ->  Seq Scan on supplier  (cost=0.00..1550.00 rows=100000 width=72) (actual time=0.037..21.918 rows=99877 loops=1)
               ->  Hash  (cost=1200280.39..1200280.39 rows=102 width=36) (actual time=6915.341..6915.342 rows=1 loops=1)
                     Buckets: 65536  Batches: 1  Memory Usage: 513kB
                     ->  Subquery Scan on revenue0  (cost=1198502.84..1200280.39 rows=102 width=36) (actual time=6859.703..6915.337 rows=1 loops=1)
                           ->  Finalize HashAggregate  (cost=1198502.84..1200279.37 rows=102 width=36) (actual time=6859.702..6915.333 rows=1 loops=1)
                                 Group Key: lineitem.l_suppkey
                                 Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $0)
                                 Peak Memory Usage: 0 kB
                                 Rows Removed by Filter: 99876
                                 ->  Redistribute Motion 3:3  (slice2; segments: 3)  (cost=1184799.74..1194696.43 rows=304513 width=36) (actual time=3787.035..6255.076 rows=300379 loops=1)
                                       Hash Key: lineitem.l_suppkey
                                       ->  Partial HashAggregate  (cost=1184799.74..1188606.16 rows=304513 width=36) (actual time=3832.350..6432.439 rows=299862 loops=1)
                                             Group Key: lineitem.l_suppkey
                                             Peak Memory Usage: 0 kB
                                             ->  Bitmap Heap Scan on lineitem  (cost=592.46..1162067.80 rows=2273194 width=16) (actual time=13.216..1185.088 rows=2295994 loops=1)
                                                   Recheck Cond: ((l_shipdate >= '1997-05-01'::date) AND (l_shipdate < '1997-08-01 00:00:00'::timestamp without time zone))
                                                   Rows Removed by Index Recheck: 65292
                                                   ->  Bitmap Index Scan on lineitem_l_shipdate_idx  (cost=0.00..24.16 rows=2280838 width=0) (actual time=1.762..1.762 rows=113920 loops=1)
                                                         Index Cond: ((l_shipdate >= '1997-05-01'::date) AND (l_shipdate < '1997-08-01 00:00:00'::timestamp without time zone))
 Optimizer: Postgres query optimizer
 Planning Time: 5.147 ms
   (slice0)    Executor memory: 18643K bytes.
   (slice1)    Executor memory: 16600K bytes avg x 3 workers, 16601K bytes max (seg2).  Work_mem: 35985K bytes max.
   (slice2)    Executor memory: 200130K bytes avg x 3 workers, 201497K bytes max (seg0).  Work_mem: 30897K bytes max.
   (slice3)    Executor memory: 18599K bytes.
   (slice4)    Executor memory: 16060K bytes avg x 3 workers, 16062K bytes max (seg2).  Work_mem: 35985K bytes max.
   (slice5)    Executor memory: 200130K bytes avg x 3 workers, 201497K bytes max (seg0).  Work_mem: 30897K bytes max.
 Memory used:  128000kB
 Execution Time: 14140.028 ms
(55 rows)

DROP VIEW
