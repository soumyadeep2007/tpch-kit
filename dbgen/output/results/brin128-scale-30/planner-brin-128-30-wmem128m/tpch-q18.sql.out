                                                                                                   QUERY PLAN                                                                                                    
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Gather Motion 3:1  (slice1; segments: 3)  (cost=9634442.87..11034430.18 rows=59999456 width=75) (actual time=144663.750..144663.877 rows=234 loops=1)
   Merge Key: orders.o_totalprice, orders.o_orderdate, customer.c_name, customer.c_custkey, orders.o_orderkey
   ->  GroupAggregate  (cost=9634442.87..10234437.43 rows=19999819 width=75) (actual time=144660.003..144660.495 rows=86 loops=1)
         Group Key: orders.o_totalprice, orders.o_orderdate, customer.c_name, customer.c_custkey, orders.o_orderkey
         ->  Sort  (cost=9634442.87..9684442.42 rows=19999819 width=48) (actual time=144659.984..144660.047 rows=602 loops=1)
               Sort Key: orders.o_totalprice DESC, orders.o_orderdate, customer.c_name, customer.c_custkey, orders.o_orderkey
               Sort Method:  quicksort  Memory: 315kB
               Executor Memory: 296kB  Segments: 3  Max: 106kB (segment 2)
               ->  Hash Join  (cost=4556277.55..7055308.99 rows=19999819 width=48) (actual time=143005.244..144658.637 rows=602 loops=1)
                     Hash Cond: (orders.o_custkey = customer.c_custkey)
                     Extra Text: (seg0)   Initial batch 0:
 (seg0)     Wrote 181250K bytes to inner workfile.
 (seg0)     Wrote 27K bytes to outer workfile.
 (seg0)   Initial batches 1..15:
 (seg0)     Read 181250K bytes from inner workfile: 12084K avg x 15 nonempty batches, 12112K max.
 (seg0)     Read 27K bytes from outer workfile: 2K avg x 15 nonempty batches, 4K max.
 (seg0)   Hash chain length 2.4 avg, 13 max, using 1852053 of 2097152 buckets.
                     Extra Text: (seg2)   Initial batch 0:
 (seg2)     Wrote 181250K bytes to inner workfile.
 (seg2)     Wrote 30K bytes to outer workfile.
 (seg2)   Initial batches 1..15:
 (seg2)     Read 181250K bytes from inner workfile: 12084K avg x 15 nonempty batches, 12112K max.
 (seg2)     Read 30K bytes from outer workfile: 2K avg x 15 nonempty batches, 5K max.
 (seg2)   Hash chain length 2.4 avg, 13 max, using 1852053 of 2097152 buckets.
                     ->  Hash Join  (cost=4409547.55..6578264.88 rows=19999819 width=29) (actual time=138034.102..140491.459 rows=602 loops=1)
                           Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                           Extra Text: (seg0)   Initial batch 0:
 (seg0)     Wrote 679623K bytes to inner workfile.
 (seg0)     Wrote 21K bytes to outer workfile.
 (seg0)   Initial batches 1..31:
 (seg0)     Read 635789K bytes from inner workfile: 21924K avg x 29 nonempty batches, 21973K max.
 (seg0)     Read 21K bytes from outer workfile: 1K avg x 29 nonempty batches, 2K max.
 (seg0)   Hash chain length 3.7 avg, 16 max, using 3822831 of 3932160 buckets.  Skipped 2 empty batches.
                           Extra Text: (seg2)   Initial batch 0:
 (seg2)     Wrote 679341K bytes to inner workfile.
 (seg2)     Wrote 26K bytes to outer workfile.
 (seg2)   Initial batches 1..31:
 (seg2)     Read 635528K bytes from inner workfile: 21915K avg x 29 nonempty batches, 21996K max.
 (seg2)     Read 26K bytes from outer workfile: 1K avg x 29 nonempty batches, 2K max.
 (seg2)   Hash chain length 3.7 avg, 17 max, using 3821521 of 3932160 buckets.  Skipped 2 empty batches.
                           ->  Redistribute Motion 3:3  (slice2; segments: 3)  (cost=3983562.55..5817244.84 rows=19999819 width=21) (actual time=125942.122..127234.242 rows=602 loops=1)
                                 Hash Key: lineitem.l_orderkey
                                 ->  Hash Join  (cost=3983562.55..5417248.47 rows=19999819 width=21) (actual time=112309.117..140030.627 rows=580 loops=1)
                                       Hash Cond: (lineitem.l_orderkey = lineitem_1.l_orderkey)
                                       Extra Text: (seg0)   Initial batch 0:
 (seg0)     Wrote 7K bytes to inner workfile.
 (seg0)     Wrote 2076531K bytes to outer workfile.
 (seg0)   Initial batches 1..63:
 (seg0)     Read 7K bytes from inner workfile: 1K avg x 60 nonempty batches, 1K max.
 (seg0)     Read 1977535K bytes from outer workfile: 32959K avg x 60 nonempty batches, 33061K max.
 (seg0)   Hash chain length 1.0 avg, 1 max, using 234 of 15990784 buckets.  Skipped 3 empty batches.
                                       ->  Seq Scan on lineitem  (cost=0.00..886187.56 rows=59999456 width=13) (actual time=0.142..16297.939 rows=60003310 loops=1)
                                       ->  Hash  (cost=3616019.03..3616019.03 rows=27272762 width=8) (actual time=97133.278..97133.278 rows=234 loops=1)
                                             Buckets: 262144  Batches: 64  Memory Usage: 2049kB
                                             ->  Broadcast Motion 3:3  (slice3; segments: 3)  (cost=2679140.05..3616019.03 rows=27272762 width=8) (actual time=96779.229..96953.992 rows=234 loops=1)
                                                   ->  HashAggregate  (cost=2679140.05..3161473.00 rows=9090921 width=8) (actual time=48141.297..97131.085 rows=86 loops=1)
                                                         Group Key: lineitem_1.l_orderkey
                                                         Filter: (sum(lineitem_1.l_quantity) > '314'::numeric)
                                                         Planned Partitions: 128
                                                         Peak Memory Usage: 0 kB
                                                         Rows Removed by Filter: 14997602
                                                         ->  Redistribute Motion 3:3  (slice4; segments: 3)  (cost=0.00..2086176.68 rows=59999456 width=13) (actual time=0.100..23223.187 rows=60021934 loops=1)
                                                               Hash Key: lineitem_1.l_orderkey
                                                               ->  Seq Scan on lineitem lineitem_1  (cost=0.00..886187.56 rows=59999456 width=13) (actual time=0.108..20904.711 rows=60003310 loops=1)
                           ->  Hash  (cost=216512.00..216512.00 rows=15000000 width=24) (actual time=10913.680..10913.681 rows=15003291 loops=1)
                                 Buckets: 131072  Batches: 32  Memory Usage: 28461kB
                                 ->  Seq Scan on orders  (cost=0.00..216512.00 rows=15000000 width=24) (actual time=0.739..5646.369 rows=15003291 loops=1)
                     ->  Hash  (cost=83888.00..83888.00 rows=4500000 width=23) (actual time=3406.264..3406.264 rows=4500000 loops=1)
                           Buckets: 131072  Batches: 16  Memory Usage: 16438kB
                           ->  Broadcast Motion 3:3  (slice5; segments: 3)  (cost=0.00..83888.00 rows=4500000 width=23) (actual time=2.154..2061.052 rows=4500000 loops=1)
                                 ->  Seq Scan on customer  (cost=0.00..23888.00 rows=1500000 width=23) (actual time=0.958..763.129 rows=1501094 loops=1)
 Optimizer: Postgres query optimizer
 Planning Time: 6.794 ms
   (slice0)    Executor memory: 6285K bytes.
 * (slice1)    Executor memory: 49328K bytes avg x 3 workers, 49356K bytes max (seg0).  Work_mem: 28461K bytes max, 823567K bytes wanted.
 * (slice2)    Executor memory: 6084K bytes avg x 3 workers, 6084K bytes max (seg0).  Work_mem: 2049K bytes max, 2058K bytes wanted.
   (slice3)    Executor memory: 22023K bytes avg x 3 workers, 22023K bytes max (seg0).  Work_mem: 39089K bytes max.
   (slice4)    Executor memory: 38K bytes avg x 3 workers, 38K bytes max (seg0).
   (slice5)    Executor memory: 38K bytes avg x 3 workers, 38K bytes max (seg0).
 Memory used:  128000kB
 Memory wanted:  4119134kB
 Execution Time: 144679.080 ms
(82 rows)

