                                                                                              QUERY PLAN                                                                                              
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Gather Motion 3:1  (slice1; segments: 3)  (cost=1495939.03..1495939.10 rows=5 width=24) (actual time=48505.785..48505.790 rows=5 loops=1)
   Merge Key: orders.o_orderpriority
   ->  Sort  (cost=1495939.03..1495939.04 rows=2 width=24) (actual time=48498.354..48498.368 rows=2 loops=1)
         Sort Key: orders.o_orderpriority
         Sort Method:  quicksort  Memory: 75kB
         Executor Memory: 177kB  Segments: 3  Max: 59kB (segment 0)
         ->  Finalize HashAggregate  (cost=1495939.01..1495939.02 rows=2 width=24) (actual time=48498.222..48498.223 rows=2 loops=1)
               Group Key: orders.o_orderpriority
               Peak Memory Usage: 0 kB
               ->  Redistribute Motion 3:3  (slice2; segments: 3)  (cost=1495938.83..1495938.98 rows=5 width=24) (actual time=48494.528..48498.168 rows=6 loops=1)
                     Hash Key: orders.o_orderpriority
                     ->  Partial HashAggregate  (cost=1495938.83..1495938.88 rows=5 width=24) (actual time=48493.057..48493.059 rows=5 loops=1)
                           Group Key: orders.o_orderpriority
                           Peak Memory Usage: 0 kB
                           ->  HashAggregate  (cost=1489417.44..1493765.04 rows=434759 width=16) (actual time=48025.460..48320.465 rows=520631 loops=1)
                                 Group Key: (RowIdExpr)
                                 Peak Memory Usage: 0 kB
                                 ->  Redistribute Motion 3:3  (slice3; segments: 3)  (cost=313694.57..1488330.55 rows=434759 width=16) (actual time=26440.659..46987.913 rows=1434616 loops=1)
                                       Hash Key: (RowIdExpr)
                                       ->  Hash Join  (cost=313694.57..1479635.36 rows=434759 width=16) (actual time=26394.044..47399.314 rows=1434573 loops=1)
                                             Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                             Extra Text: (seg0)   Initial batch 0:
 (seg0)     Wrote 43143K bytes to inner workfile.
 (seg0)     Wrote 518481K bytes to outer workfile.
 (seg0)   Initial batch 1:
 (seg0)     Read 43143K bytes from inner workfile.
 (seg0)     Read 518481K bytes from outer workfile.
 (seg0)   Hash chain length 3.4 avg, 14 max, using 503718 of 524288 buckets.
                                             ->  Seq Scan on lineitem  (cost=0.00..1036186.20 rows=19999819 width=8) (actual time=1.280..23009.985 rows=37938467 loops=1)
                                                   Filter: (l_commitdate < l_receiptdate)
                                                   Rows Removed by Filter: 22064843
                                             ->  Hash  (cost=288856.34..288856.34 rows=1778579 width=24) (actual time=975.143..975.144 rows=1701175 loops=1)
                                                   Buckets: 262144  Batches: 2  Memory Usage: 55273kB
                                                   ->  Broadcast Motion 3:3  (slice4; segments: 3)  (cost=162.20..288856.34 rows=1778579 width=24) (actual time=13.607..563.344 rows=1701175 loops=1)
                                                         ->  Bitmap Heap Scan on orders  (cost=162.20..265141.96 rows=592860 width=24) (actual time=18.856..472.918 rows=567512 loops=1)
                                                               Recheck Cond: ((o_orderdate >= '1996-09-01'::date) AND (o_orderdate < '1996-12-01 00:00:00'::timestamp without time zone))
                                                               Rows Removed by Index Recheck: 9879
                                                               ->  Bitmap Index Scan on orders_o_orderdate_idx  (cost=0.00..13.98 rows=596536 width=0) (actual time=1.856..1.857 rows=25600 loops=1)
                                                                     Index Cond: ((o_orderdate >= '1996-09-01'::date) AND (o_orderdate < '1996-12-01 00:00:00'::timestamp without time zone))
 Optimizer: Postgres query optimizer
 Planning Time: 16.788 ms
   (slice0)    Executor memory: 12391K bytes.
   (slice1)    Executor memory: 59K bytes avg x 3 workers, 59K bytes max (seg0).  Work_mem: 59K bytes max.
   (slice2)    Executor memory: 58305K bytes avg x 3 workers, 58646K bytes max (seg2).  Work_mem: 65681K bytes max.
 * (slice3)    Executor memory: 55449K bytes avg x 3 workers, 55449K bytes max (seg0).  Work_mem: 55273K bytes max, 108372K bytes wanted.
   (slice4)    Executor memory: 43340K bytes avg x 3 workers, 43340K bytes max (seg0).
 Memory used:  128000kB
 Memory wanted:  650928kB
 Execution Time: 48542.008 ms
(49 rows)

