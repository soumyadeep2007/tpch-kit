                                                                                                                 QUERY PLAN                                                                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Gather Motion 3:1  (slice1; segments: 3)  (cost=1268049.19..1268049.26 rows=5 width=24) (actual time=64718.424..64718.429 rows=5 loops=1)
   Merge Key: orders.o_orderpriority
   ->  Sort  (cost=1268049.19..1268049.19 rows=2 width=24) (actual time=64712.772..64712.778 rows=2 loops=1)
         Sort Key: orders.o_orderpriority
         Sort Method:  quicksort  Memory: 75kB
         Executor Memory: 177kB  Segments: 3  Max: 59kB (segment 0)
         ->  Finalize HashAggregate  (cost=1268049.16..1268049.18 rows=2 width=24) (actual time=64712.639..64712.644 rows=2 loops=1)
               Group Key: orders.o_orderpriority
               Extra Text: (seg0)   hash table(s): 1; chain length 1.0 avg, 1 max; using 2 of 4 buckets; total 1 expansions.
 
               ->  Redistribute Motion 3:3  (slice2; segments: 3)  (cost=1268048.99..1268049.14 rows=5 width=24) (actual time=64675.805..64712.609 rows=6 loops=1)
                     Hash Key: orders.o_orderpriority
                     ->  Partial HashAggregate  (cost=1268048.99..1268049.04 rows=5 width=24) (actual time=64706.201..64706.204 rows=5 loops=1)
                           Group Key: orders.o_orderpriority
                           Extra Text: (seg0)   hash table(s): 1; chain length 1.0 avg, 1 max; using 5 of 8 buckets; total 0 expansions.
 
                           ->  HashAggregate  (cost=1263794.44..1266630.80 rows=283636 width=16) (actual time=64208.057..64510.185 rows=520892 loops=1)
                                 Group Key: (RowIdExpr)
                                 Extra Text: (seg0)   hash table(s): 1; 519250 groups total in 4 batches, 1316528 spill partitions; disk usage: 15040KB; chain length 2.9 avg, 16 max; using 519250 of 5242880 buckets; total 1 expansions.
 
                                 ->  Redistribute Motion 3:3  (slice3; segments: 3)  (cost=125723.54..1263085.35 rows=283636 width=16) (actual time=37779.077..63206.876 rows=1434923 loops=1)
                                       Hash Key: (RowIdExpr)
                                       ->  Hash Join  (cost=125723.54..1257412.63 rows=283636 width=16) (actual time=37470.535..63229.454 rows=1434573 loops=1)
                                             Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                             Extra Text: (seg0)   Initial batch 0:
 (seg0)     Wrote 43143K bytes to inner workfile.
 (seg0)     Wrote 518481K bytes to outer workfile.
 (seg0)   Initial batch 1:
 (seg0)     Read 43143K bytes from inner workfile.
 (seg0)     Read 518481K bytes from outer workfile.
 (seg0)   Work file set: 1 files (0 compressed), max file size 44171264, min file size 32768, compression buffer size 0 bytes
 (seg0)   Hash chain length 3.4 avg, 14 max, using 503718 of 524288 buckets.
                                             ->  Seq Scan on lineitem  (cost=0.00..1034421.20 rows=19999819 width=8) (actual time=1.697..37315.759 rows=37938467 loops=1)
                                                   Filter: (l_commitdate < l_receiptdate)
                                                   Rows Removed by Filter: 22064843
                                             ->  Hash  (cost=104973.88..104973.88 rows=1659973 width=24) (actual time=2578.125..2578.126 rows=1701175 loops=1)
                                                   Buckets: 262144  Batches: 2  Memory Usage: 55273kB
                                                   ->  Broadcast Motion 3:3  (slice4; segments: 3)  (cost=150.36..104973.88 rows=1659973 width=24) (actual time=1008.940..2184.702 rows=1701175 loops=1)
                                                         ->  Bitmap Heap Scan on orders  (cost=150.36..82840.91 rows=553324 width=24) (actual time=1010.964..2071.535 rows=567512 loops=1)
                                                               Recheck Cond: ((o_orderdate >= '1996-09-01'::date) AND (o_orderdate < '1996-12-01 00:00:00'::timestamp without time zone))
                                                               Rows Removed by Index Recheck: 3626792
                                                               ->  Bitmap Index Scan on orders_o_orderdate_idx  (cost=0.00..12.03 rows=1363636 width=0) (actual time=1.890..1.890 rows=1280 loops=1)
                                                                     Index Cond: ((o_orderdate >= '1996-09-01'::date) AND (o_orderdate < '1996-12-01 00:00:00'::timestamp without time zone))
 Optimizer: Postgres-based planner
 Planning Time: 12.870 ms
   (slice0)    Executor memory: 12389K bytes.
 * (slice1)    Executor memory: 59K bytes avg x 3 workers, 59K bytes max (seg0).  Work_mem: 59K bytes max, 24K bytes wanted.
 * (slice2)    Executor memory: 58190K bytes avg x 3 workers, 58660K bytes max (seg1).  Work_mem: 65681K bytes max, 81937K bytes wanted.
 * (slice3)    Executor memory: 55634K bytes avg x 3 workers, 55634K bytes max (seg0).  Work_mem: 55273K bytes max, 108372K bytes wanted.
   (slice4)    Executor memory: 3431K bytes avg x 3 workers, 3431K bytes max (seg0).
 Memory used:  128000kB
 Memory wanted:  650928kB
 Execution Time: 64748.036 ms
(53 rows)

