                                                                        QUERY PLAN                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=2956824.35..2956824.37 rows=1 width=32)
   ->  Gather Motion 3:1  (slice1; segments: 3)  (cost=2956824.29..2956824.34 rows=3 width=32)
         ->  Partial Aggregate  (cost=2956824.29..2956824.30 rows=1 width=32)
               ->  Hash Join  (cost=1911896.45..2956584.52 rows=95906 width=8)
                     Hash Cond: (lineitem.l_partkey = part.p_partkey)
                     Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
                     ->  Seq Scan on lineitem  (cost=0.00..884422.56 rows=59999456 width=17)
                     ->  Hash  (cost=1911535.20..1911535.20 rows=28900 width=40)
                           ->  Broadcast Motion 3:3  (slice2; segments: 3)  (cost=1843786.38..1911535.20 rows=28900 width=40)
                                 ->  Hash Join  (cost=1843786.38..1911149.87 rows=9633 width=40)
                                       Hash Cond: (lineitem_1.l_partkey = part.p_partkey)
                                       ->  Finalize HashAggregate  (cost=1838779.42..1880684.04 rows=2008914 width=36)
                                             Group Key: lineitem_1.l_partkey
                                             Planned Partitions: 16
                                             ->  Redistribute Motion 3:3  (slice3; segments: 3)  (cost=1477385.93..1746495.46 rows=6026708 width=36)
                                                   Hash Key: lineitem_1.l_partkey
                                                   ->  Partial HashAggregate  (cost=1477385.93..1625961.30 rows=6026708 width=36)
                                                         Group Key: lineitem_1.l_partkey
                                                         Planned Partitions: 32
                                                         ->  Seq Scan on lineitem lineitem_1  (cost=0.00..884422.56 rows=59999456 width=9)
                                       ->  Hash  (cost=4887.07..4887.07 rows=9591 width=4)
                                             ->  Bitmap Heap Scan on part  (cost=117.77..4887.07 rows=9591 width=4)
                                                   Recheck Cond: ((p_container = 'SM BOX'::bpchar) AND (p_brand = 'Brand#53'::bpchar))
                                                   ->  Bitmap Index Scan on part_p_container_p_brand_p_partkey_idx  (cost=0.00..115.37 rows=1919 width=0)
                                                         Index Cond: ((p_container = 'SM BOX'::bpchar) AND (p_brand = 'Brand#53'::bpchar))
 Optimizer: Postgres-based planner
(26 rows)

