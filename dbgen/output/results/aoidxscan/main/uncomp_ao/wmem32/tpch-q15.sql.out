CREATE VIEW
                                                                              QUERY PLAN                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Gather Motion 3:1  (slice1; segments: 3)  (cost=1242701.60..1242705.84 rows=300 width=103)
   Merge Key: supplier.s_suppkey
   InitPlan 1 (returns $0)  (slice3)
     ->  Finalize Aggregate  (cost=1237249.69..1237249.70 rows=1 width=32)
           ->  Gather Motion 3:1  (slice4; segments: 3)  (cost=1237249.63..1237249.68 rows=3 width=32)
                 ->  Partial Aggregate  (cost=1237249.63..1237249.64 rows=1 width=32)
                       ->  Finalize HashAggregate  (cost=1234752.02..1236000.83 rows=99905 width=36)
                             Group Key: lineitem_1.l_suppkey
                             ->  Redistribute Motion 3:3  (slice5; segments: 3)  (cost=1219857.58..1232504.31 rows=299695 width=36)
                                   Hash Key: lineitem_1.l_suppkey
                                   ->  Partial HashAggregate  (cost=1219857.58..1226510.41 rows=299695 width=36)
                                         Group Key: lineitem_1.l_suppkey
                                         ->  Seq Scan on lineitem lineitem_1  (cost=0.00..1184419.84 rows=2381119 width=16)
                                               Filter: ((l_shipdate >= '1997-05-01'::date) AND (l_shipdate < '1997-08-01 00:00:00'::timestamp without time zone))
   ->  Sort  (cost=1242701.60..1242701.85 rows=100 width=103)
         Sort Key: supplier.s_suppkey
         ->  Hash Join  (cost=1240927.78..1242698.28 rows=100 width=103)
               Hash Cond: (supplier.s_suppkey = revenue0.supplier_no)
               ->  Seq Scan on supplier  (cost=0.00..1507.00 rows=100000 width=71)
               ->  Hash  (cost=1240926.53..1240926.53 rows=100 width=36)
                     ->  Subquery Scan on revenue0  (cost=1238591.86..1240926.53 rows=100 width=36)
                           ->  Finalize HashAggregate  (cost=1238591.86..1240925.53 rows=100 width=36)
                                 Group Key: lineitem.l_suppkey
                                 Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $0)
                                 ->  Redistribute Motion 3:3  (slice2; segments: 3)  (cost=1219857.58..1232504.31 rows=299695 width=36)
                                       Hash Key: lineitem.l_suppkey
                                       ->  Partial HashAggregate  (cost=1219857.58..1226510.41 rows=299695 width=36)
                                             Group Key: lineitem.l_suppkey
                                             ->  Seq Scan on lineitem  (cost=0.00..1184419.84 rows=2381119 width=16)
                                                   Filter: ((l_shipdate >= '1997-05-01'::date) AND (l_shipdate < '1997-08-01 00:00:00'::timestamp without time zone))
 Optimizer: Postgres-based planner
(31 rows)

DROP VIEW
