                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=19001561.33..19001561.66 rows=23 width=34)
   ->  Gather Motion 3:1  (slice1; segments: 3)  (cost=19001561.33..19001561.66 rows=23 width=34)
         Merge Key: (count(*)), supplier.s_name
         ->  Limit  (cost=19001561.33..19001561.35 rows=8 width=34)
               ->  Sort  (cost=19001561.33..19001561.35 rows=9 width=34)
                     Sort Key: (count(*)) DESC, supplier.s_name
                     ->  GroupAggregate  (cost=19001561.05..19001561.20 rows=9 width=34)
                           Group Key: supplier.s_name
                           ->  Sort  (cost=19001561.05..19001561.07 rows=9 width=26)
                                 Sort Key: supplier.s_name
                                 ->  Redistribute Motion 3:3  (slice2; segments: 3)  (cost=16966206.55..19001560.91 rows=9 width=26)
                                       Hash Key: supplier.s_name
                                       ->  Hash Join  (cost=16966206.55..19001560.74 rows=9 width=26)
                                             Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                             ->  Seq Scan on orders  (cost=0.00..2007887.23 rows=7324500 width=8)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                             ->  Hash  (cost=16966206.44..16966206.44 rows=9 width=42)
                                                   ->  Redistribute Motion 3:3  (slice3; segments: 3)  (cost=16966206.18..16966206.44 rows=9 width=42)
                                                         Hash Key: l1.l_orderkey
                                                         ->  HashAggregate  (cost=16966206.18..16966206.27 rows=9 width=42)
                                                               Group Key: (RowIdExpr)
                                                               ->  Redistribute Motion 3:3  (slice4; segments: 3)  (cost=8299185.11..16966206.16 rows=9 width=42)
                                                                     Hash Key: (RowIdExpr)
                                                                     ->  Hash Join  (cost=8299185.11..16966205.99 rows=9 width=42)
                                                                           Hash Cond: (l2.l_orderkey = l1.l_orderkey)
                                                                           Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                                                                           ->  Seq Scan on lineitem l2  (cost=0.00..8442022.66 rows=59999456 width=12)
                                                                           ->  Hash  (cost=8299184.79..8299184.79 rows=26 width=38)
                                                                                 ->  Broadcast Motion 3:3  (slice5; segments: 3)  (cost=7342486.78..8299184.79 rows=26 width=38)
                                                                                       ->  Hash Anti Join  (cost=7342486.78..8299184.45 rows=9 width=38)
                                                                                             Hash Cond: (l1.l_orderkey = l3.l_orderkey)
                                                                                             Join Filter: (l3.l_suppkey <> l1.l_suppkey)
                                                                                             ->  Redistribute Motion 3:3  (slice6; segments: 3)  (cost=2924390.37..3849309.57 rows=799993 width=38)
                                                                                                   Hash Key: l1.l_orderkey
                                                                                                   ->  Hash Join  (cost=2924390.37..3833309.72 rows=799993 width=38)
                                                                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                                                                         ->  Bitmap Heap Scan on lineitem l1  (cost=2907512.40..3743688.30 rows=19999819 width=12)
                                                                                                               Recheck Cond: (l_commitdate < l_receiptdate)
                                                                                                               ->  Bitmap Index Scan on lineitem_l_orderkey_idx_part1  (cost=0.00..2902512.44 rows=19999819 width=0)
                                                                                                         ->  Hash  (cost=16727.97..16727.97 rows=12000 width=30)
                                                                                                               ->  Broadcast Motion 3:3  (slice7; segments: 3)  (cost=2.12..16727.97 rows=12000 width=30)
                                                                                                                     ->  Hash Join  (cost=2.12..16567.97 rows=4000 width=30)
                                                                                                                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                                                                           ->  Seq Scan on supplier  (cost=0.00..16263.65 rows=100000 width=34)
                                                                                                                           ->  Hash  (cost=2.11..2.11 rows=1 width=4)
                                                                                                                                 ->  Broadcast Motion 3:3  (slice8; segments: 3)  (cost=0.00..2.11 rows=1 width=4)
                                                                                                                                       ->  Seq Scan on nation  (cost=0.00..2.09 rows=1 width=4)
                                                                                                                                             Filter: (n_name = 'FRANCE'::bpchar)
                                                                                             ->  Hash  (cost=4143684.68..4143684.68 rows=19999819 width=12)
                                                                                                   ->  Redistribute Motion 3:3  (slice9; segments: 3)  (cost=2907512.40..4143684.68 rows=19999819 width=12)
                                                                                                         Hash Key: l3.l_orderkey
                                                                                                         ->  Bitmap Heap Scan on lineitem l3  (cost=2907512.40..3743688.30 rows=19999819 width=12)
                                                                                                               Recheck Cond: (l_commitdate < l_receiptdate)
                                                                                                               ->  Bitmap Index Scan on lineitem_l_orderkey_idx_part1  (cost=0.00..2902512.44 rows=19999819 width=0)
 Optimizer: Postgres-based planner
(55 rows)

