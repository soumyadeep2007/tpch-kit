                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=13861043.54..13861043.87 rows=23 width=34)
   ->  Gather Motion 3:1  (slice1; segments: 3)  (cost=13861043.54..13861043.87 rows=23 width=34)
         Merge Key: (count(*)), supplier.s_name
         ->  Limit  (cost=13861043.54..13861043.56 rows=8 width=34)
               ->  Sort  (cost=13861043.54..13861043.56 rows=9 width=34)
                     Sort Key: (count(*)) DESC, supplier.s_name
                     ->  GroupAggregate  (cost=13861043.26..13861043.41 rows=9 width=34)
                           Group Key: supplier.s_name
                           ->  Sort  (cost=13861043.26..13861043.28 rows=9 width=26)
                                 Sort Key: supplier.s_name
                                 ->  Redistribute Motion 3:3  (slice2; segments: 3)  (cost=11825800.51..13861043.12 rows=9 width=26)
                                       Hash Key: supplier.s_name
                                       ->  Hash Join  (cost=11825800.51..13861042.95 rows=9 width=26)
                                             Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                             ->  Seq Scan on orders  (cost=0.00..2008094.23 rows=7239500 width=8)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                             ->  Hash  (cost=11825800.40..11825800.40 rows=9 width=42)
                                                   ->  Redistribute Motion 3:3  (slice3; segments: 3)  (cost=11825800.14..11825800.40 rows=9 width=42)
                                                         Hash Key: l1.l_orderkey
                                                         ->  HashAggregate  (cost=11825800.14..11825800.23 rows=9 width=42)
                                                               Group Key: (RowIdExpr)
                                                               ->  Redistribute Motion 3:3  (slice4; segments: 3)  (cost=3152932.20..11825800.12 rows=9 width=42)
                                                                     Hash Key: (RowIdExpr)
                                                                     ->  Hash Join  (cost=3152932.20..11825799.95 rows=9 width=42)
                                                                           Hash Cond: (l2.l_orderkey = l1.l_orderkey)
                                                                           Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                                                                           ->  Seq Scan on lineitem l2  (cost=0.00..8447869.66 rows=59999456 width=12)
                                                                           ->  Hash  (cost=3152931.88..3152931.88 rows=26 width=38)
                                                                                 ->  Broadcast Motion 3:3  (slice5; segments: 3)  (cost=2184797.31..3152931.88 rows=26 width=38)
                                                                                       ->  Hash Anti Join  (cost=2184797.31..3152931.53 rows=9 width=38)
                                                                                             Hash Cond: (l1.l_orderkey = l3.l_orderkey)
                                                                                             Join Filter: (l3.l_suppkey <> l1.l_suppkey)
                                                                                             ->  Redistribute Motion 3:3  (slice6; segments: 3)  (cost=342367.13..1273359.80 rows=791153 width=38)
                                                                                                   Hash Key: l1.l_orderkey
                                                                                                   ->  Hash Join  (cost=342367.13..1257536.75 rows=791153 width=38)
                                                                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                                                                         ->  Bitmap Heap Scan on lineitem l1  (cost=325397.60..1168022.07 rows=19999819 width=12)
                                                                                                               Recheck Cond: (l_commitdate < l_receiptdate)
                                                                                                               ->  Bitmap Index Scan on lineitem_l_orderkey_idx_part1  (cost=0.00..320397.65 rows=19999819 width=0)
                                                                                                         ->  Hash  (cost=16819.52..16819.52 rows=12000 width=30)
                                                                                                               ->  Broadcast Motion 3:3  (slice7; segments: 3)  (cost=2.12..16819.52 rows=12000 width=30)
                                                                                                                     ->  Hash Join  (cost=2.12..16659.52 rows=4000 width=30)
                                                                                                                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                                                                           ->  Seq Scan on supplier  (cost=0.00..16355.20 rows=100000 width=34)
                                                                                                                           ->  Hash  (cost=2.11..2.11 rows=1 width=4)
                                                                                                                                 ->  Broadcast Motion 3:3  (slice8; segments: 3)  (cost=0.00..2.11 rows=1 width=4)
                                                                                                                                       ->  Seq Scan on nation  (cost=0.00..2.09 rows=1 width=4)
                                                                                                                                             Filter: (n_name = 'FRANCE'::bpchar)
                                                                                             ->  Hash  (cost=1568018.45..1568018.45 rows=19999819 width=12)
                                                                                                   ->  Redistribute Motion 3:3  (slice9; segments: 3)  (cost=325397.60..1568018.45 rows=19999819 width=12)
                                                                                                         Hash Key: l3.l_orderkey
                                                                                                         ->  Bitmap Heap Scan on lineitem l3  (cost=325397.60..1168022.07 rows=19999819 width=12)
                                                                                                               Recheck Cond: (l_commitdate < l_receiptdate)
                                                                                                               ->  Bitmap Index Scan on lineitem_l_orderkey_idx_part1  (cost=0.00..320397.65 rows=19999819 width=0)
 Optimizer: Postgres-based planner
(55 rows)

