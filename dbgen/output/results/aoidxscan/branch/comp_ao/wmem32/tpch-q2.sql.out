                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Gather Motion 3:1  (slice1; segments: 3)  (cost=2803217.70..2803218.01 rows=22 width=193)
   Merge Key: supplier.s_acctbal, nation.n_name, supplier.s_name, part.p_partkey
   ->  Sort  (cost=2803217.70..2803217.72 rows=7 width=193)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         ->  Hash Join  (cost=1466839.37..2803217.59 rows=7 width=193)
               Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
               ->  Redistribute Motion 3:3  (slice2; segments: 3)  (cost=1449655.70..2786033.82 rows=7 width=34)
                     Hash Key: partsupp.ps_suppkey
                     ->  Hash Join  (cost=1449655.70..2786033.67 rows=7 width=34)
                           Hash Cond: ((partsupp.ps_partkey = part.p_partkey) AND (partsupp.ps_supplycost = (min(partsupp_1.ps_supplycost))))
                           ->  Seq Scan on partsupp  (cost=0.00..1287812.66 rows=8000000 width=14)
                           ->  Hash  (cost=1448996.39..1448996.39 rows=43954 width=66)
                                 ->  Broadcast Motion 3:3  (slice3; segments: 3)  (cost=1410387.08..1448996.39 rows=43954 width=66)
                                       ->  Hash Join  (cost=1410387.08..1448410.35 rows=14651 width=66)
                                             Hash Cond: (partsupp_1.ps_partkey = part.p_partkey)
                                             ->  HashAggregate  (cost=1399646.58..1417469.65 rows=1588410 width=36)
                                                   Group Key: partsupp_1.ps_partkey
                                                   Planned Partitions: 8
                                                   ->  Redistribute Motion 3:3  (slice4; segments: 3)  (cost=18483.67..1383948.62 rows=1588410 width=10)
                                                         Hash Key: partsupp_1.ps_partkey
                                                         ->  Hash Join  (cost=18483.67..1352180.42 rows=1588410 width=10)
                                                               Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                                                               ->  Seq Scan on partsupp partsupp_1  (cost=0.00..1287812.66 rows=8000000 width=14)
                                                               ->  Hash  (cost=17733.67..17733.67 rows=60000 width=4)
                                                                     ->  Broadcast Motion 3:3  (slice5; segments: 3)  (cost=3.47..17733.67 rows=60000 width=4)
                                                                           ->  Hash Join  (cost=3.47..16933.67 rows=20000 width=4)
                                                                                 Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                                                                 ->  Seq Scan on supplier supplier_1  (cost=0.00..16355.20 rows=100000 width=8)
                                                                                 ->  Hash  (cost=3.40..3.40 rows=5 width=4)
                                                                                       ->  Broadcast Motion 3:3  (slice6; segments: 3)  (cost=1.23..3.40 rows=5 width=4)
                                                                                             ->  Hash Join  (cost=1.23..3.34 rows=2 width=4)
                                                                                                   Hash Cond: (nation_1.n_regionkey = region_1.r_regionkey)
                                                                                                   ->  Seq Scan on nation nation_1  (cost=0.00..2.07 rows=8 width=8)
                                                                                                   ->  Hash  (cost=1.22..1.22 rows=1 width=4)
                                                                                                         ->  Broadcast Motion 3:3  (slice7; segments: 3)  (cost=0.00..1.22 rows=1 width=4)
                                                                                                               ->  Seq Scan on region region_1  (cost=0.00..1.20 rows=1 width=4)
                                                                                                                     Filter: (r_name = 'EUROPE'::bpchar)
                                             ->  Hash  (cost=10509.91..10509.91 rows=18448 width=30)
                                                   ->  Bitmap Heap Scan on part  (cost=6602.91..10509.91 rows=18448 width=30)
                                                         Recheck Cond: (p_size = 1)
                                                         Filter: ((p_type)::text ~~ '%NICKEL'::text)
                                                         ->  Bitmap Index Scan on part_p_size_idx  (cost=0.00..6598.30 rows=39133 width=0)
                                                               Index Cond: (p_size = 1)
               ->  Hash  (cost=16933.67..16933.67 rows=20000 width=167)
                     ->  Hash Join  (cost=3.47..16933.67 rows=20000 width=167)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Seq Scan on supplier  (cost=0.00..16355.20 rows=100000 width=145)
                           ->  Hash  (cost=3.40..3.40 rows=5 width=30)
                                 ->  Broadcast Motion 3:3  (slice8; segments: 3)  (cost=1.23..3.40 rows=5 width=30)
                                       ->  Hash Join  (cost=1.23..3.34 rows=2 width=30)
                                             Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                             ->  Seq Scan on nation  (cost=0.00..2.07 rows=8 width=34)
                                             ->  Hash  (cost=1.22..1.22 rows=1 width=4)
                                                   ->  Broadcast Motion 3:3  (slice9; segments: 3)  (cost=0.00..1.22 rows=1 width=4)
                                                         ->  Seq Scan on region  (cost=0.00..1.20 rows=1 width=4)
                                                               Filter: (r_name = 'EUROPE'::bpchar)
 Optimizer: Postgres-based planner
(57 rows)

