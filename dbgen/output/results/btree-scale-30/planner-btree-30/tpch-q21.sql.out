                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4260429.82..4260430.14 rows=23 width=34) (actual time=113153.772..113153.912 rows=100 loops=1)
   ->  Gather Motion 3:1  (slice1; segments: 3)  (cost=4260429.82..4260430.14 rows=23 width=34) (actual time=113153.769..113153.902 rows=100 loops=1)
         Merge Key: (count(*)), supplier.s_name
         ->  Limit  (cost=4260429.82..4260429.84 rows=8 width=34) (actual time=113152.449..113152.478 rows=100 loops=1)
               ->  Sort  (cost=4260429.81..4260429.84 rows=9 width=34) (actual time=113152.448..113152.455 rows=100 loops=1)
                     Sort Key: (count(*)) DESC, supplier.s_name
                     Sort Method:  top-N heapsort  Memory: 115kB
                     Executor Memory: 178kB  Segments: 3  Max: 60kB (segment 0)
                     ->  GroupAggregate  (cost=4260429.53..4260429.68 rows=9 width=34) (actual time=113138.741..113150.538 rows=4081 loops=1)
                           Group Key: supplier.s_name
                           ->  Sort  (cost=4260429.53..4260429.55 rows=9 width=26) (actual time=113138.730..113141.932 rows=40599 loops=1)
                                 Sort Key: supplier.s_name
                                 Sort Method:  quicksort  Memory: 14813kB
                                 Executor Memory: 12039kB  Segments: 3  Max: 4077kB (segment 0)
                                 ->  Redistribute Motion 3:3  (slice2; segments: 3)  (cost=3979030.01..4260429.40 rows=9 width=26) (actual time=108158.999..113022.208 rows=40599 loops=1)
                                       Hash Key: supplier.s_name
                                       ->  Hash Join  (cost=3979030.01..4260429.22 rows=9 width=26) (actual time=108111.570..112983.240 rows=39640 loops=1)
                                             Hash Cond: (orders.o_orderkey = l1.l_orderkey)
                                             Extra Text: (seg2)   Hash chain length 1.3 avg, 6 max, using 59923 of 131072 buckets.
                                             ->  Seq Scan on orders  (cost=0.00..254011.00 rows=7303500 width=8) (actual time=0.135..3678.413 rows=7309660 loops=1)
                                                   Filter: (o_orderstatus = 'F'::bpchar)
                                                   Rows Removed by Filter: 7693631
                                             ->  Hash  (cost=3979029.90..3979029.90 rows=9 width=42) (actual time=108109.365..108109.365 rows=80646 loops=1)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 7325kB
                                                   ->  Redistribute Motion 3:3  (slice3; segments: 3)  (cost=3979029.65..3979029.90 rows=9 width=42) (actual time=108044.589..108091.857 rows=80646 loops=1)
                                                         Hash Key: l1.l_orderkey
                                                         ->  HashAggregate  (cost=3979029.65..3979029.73 rows=9 width=42) (actual time=108044.296..108073.418 rows=80592 loops=1)
                                                               Group Key: (RowIdExpr)
                                                               Extra Text: (seg0)   hash table(s): 1; chain length 3.2 avg, 18 max; using 80200 of 131072 buckets; total 14 expansions.
 
                                                               ->  Redistribute Motion 3:3  (slice4; segments: 3)  (cost=2867844.68..3979029.62 rows=9 width=42) (actual time=72333.399..107932.160 rows=152484 loops=1)
                                                                     Hash Key: (RowIdExpr)
                                                                     ->  Hash Join  (cost=2867844.68..3979029.45 rows=9 width=42) (actual time=72299.038..107446.583 rows=152192 loops=1)
                                                                           Hash Cond: (l2.l_orderkey = l1.l_orderkey)
                                                                           Join Filter: (l2.l_suppkey <> l1.l_suppkey)
                                                                           Rows Removed by Join Filter: 134514
                                                                           Extra Text: (seg0)   Hash chain length 3.2 avg, 14 max, using 125047 of 131072 buckets.
                                                                           ->  Seq Scan on lineitem l2  (cost=0.00..886186.56 rows=59999456 width=12) (actual time=0.143..10630.062 rows=60003310 loops=1)
                                                                           ->  Hash  (cost=2867844.36..2867844.36 rows=26 width=38) (actual time=72298.260..72298.261 rows=403859 loops=1)
                                                                                 Buckets: 131072 (originally 65536)  Batches: 1 (originally 1)  Memory Usage: 32576kB
                                                                                 ->  Broadcast Motion 3:3  (slice5; segments: 3)  (cost=1712756.64..2867844.36 rows=26 width=38) (actual time=37186.459..72169.473 rows=403859 loops=1)
                                                                                       ->  Hash Anti Join  (cost=1712756.64..2867844.01 rows=9 width=38) (actual time=35781.830..72019.668 rows=134925 loops=1)
                                                                                             Hash Cond: (l1.l_orderkey = l3.l_orderkey)
                                                                                             Join Filter: (l3.l_suppkey <> l1.l_suppkey)
                                                                                             Rows Removed by Join Filter: 550128
                                                                                             Extra Text: (seg0)   Initial batch 0:
 (seg0)     Wrote 1167375K bytes to inner workfile.
 (seg0)     Wrote 87408K bytes to outer workfile.
 (seg0)   Initial batches 1..31:
 (seg0)     Read 1030909K bytes from inner workfile: 33256K avg x 31 nonempty batches, 33380K max.
 (seg0)     Wrote 456454K bytes to inner workfile: 14725K avg x 31 overflowing batches, 14795K max.
 (seg0)     Read 43037K bytes from outer workfile: 1389K avg x 31 nonempty batches, 1405K max.
 (seg0)   Overflow batches 32..63:
 (seg0)     Read 592920K bytes from inner workfile: 18529K avg x 32 nonempty batches, 18607K max.
 (seg0)     Read 44372K bytes from outer workfile: 1387K avg x 32 nonempty batches, 1403K max.
 (seg0)   Work file set: 63 files (0 compressed), max file size 34177024, min file size 32768, compression buffer size 0 bytes
 (seg0)   Hash chain length 4.0 avg, 37 max, using 9387089 of 16777216 buckets.
                                                                                             ->  Redistribute Motion 3:3  (slice6; segments: 3)  (cost=2163.34..1125788.08 rows=765670 width=38) (actual time=0.027..24445.394 rows=1515214 loops=1)
                                                                                                   Hash Key: l1.l_orderkey
                                                                                                   ->  Hash Join  (cost=2163.34..1110474.67 rows=765670 width=38) (actual time=77.288..23965.679 rows=1513121 loops=1)
                                                                                                         Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                                                                         Extra Text: (seg0)   Hash chain length 1.0 avg, 3 max, using 11452 of 131072 buckets.
                                                                                                         ->  Seq Scan on lineitem l1  (cost=0.00..1036185.20 rows=19999819 width=12) (actual time=0.110..18744.174 rows=37938467 loops=1)
                                                                                                               Filter: (l_receiptdate > l_commitdate)
                                                                                                               Rows Removed by Filter: 22064843
                                                                                                         ->  Hash  (cost=2013.34..2013.34 rows=12000 width=30) (actual time=76.111..76.112 rows=11969 loops=1)
                                                                                                               Buckets: 131072  Batches: 1  Memory Usage: 1773kB
                                                                                                               ->  Broadcast Motion 3:3  (slice7; segments: 3)  (cost=1.14..2013.34 rows=12000 width=30) (actual time=1.866..72.530 rows=11969 loops=1)
                                                                                                                     ->  Hash Join  (cost=1.14..1853.34 rows=4000 width=30) (actual time=0.706..48.134 rows=4080 loops=1)
                                                                                                                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                                                                           Extra Text: (seg0)   Hash chain length 1.0 avg, 1 max, using 1 of 131072 buckets.
                                                                                                                           ->  Seq Scan on supplier  (cost=0.00..1550.00 rows=100000 width=34) (actual time=0.072..41.724 rows=100172 loops=1)
                                                                                                                           ->  Hash  (cost=1.12..1.12 rows=1 width=4) (actual time=0.009..0.009 rows=1 loops=1)
                                                                                                                                 Buckets: 131072  Batches: 1  Memory Usage: 1025kB
                                                                                                                                 ->  Broadcast Motion 3:3  (slice8; segments: 3)  (cost=0.00..1.12 rows=1 width=4) (actual time=0.004..0.004 rows=1 loops=1)
                                                                                                                                       ->  Seq Scan on nation  (cost=0.00..1.10 rows=1 width=4) (actual time=0.064..0.067 rows=1 loops=1)
                                                                                                                                             Filter: (n_name = 'FRANCE'::bpchar)
                                                                                                                                             Rows Removed by Filter: 8
                                                                                             ->  Hash  (cost=1436181.57..1436181.57 rows=19999819 width=12) (actual time=35734.280..35734.281 rows=37946078 loops=1)
                                                                                                   Buckets: 262144 (originally 262144)  Batches: 64 (originally 32)  Memory Usage: 40453kB
                                                                                                   ->  Redistribute Motion 3:3  (slice9; segments: 3)  (cost=0.00..1436181.57 rows=19999819 width=12) (actual time=4.673..28765.921 rows=37946078 loops=1)
                                                                                                         Hash Key: l3.l_orderkey
                                                                                                         ->  Seq Scan on lineitem l3  (cost=0.00..1036185.20 rows=19999819 width=12) (actual time=0.108..22124.345 rows=37938467 loops=1)
                                                                                                               Filter: (l_receiptdate > l_commitdate)
                                                                                                               Rows Removed by Filter: 22064843
 Optimizer: Postgres-based planner
 Planning Time: 10.217 ms
   (slice0)    Executor memory: 194K bytes.
   (slice1)    Executor memory: 4073K bytes avg x 3 workers, 4136K bytes max (seg0).  Work_mem: 4077K bytes max.
   (slice2)    Executor memory: 7371K bytes avg x 3 workers, 7403K bytes max (seg1).  Work_mem: 7325K bytes max.
 * (slice3)    Executor memory: 13156K bytes avg x 3 workers, 13178K bytes max (seg2).  Work_mem: 15401K bytes max, 15401K bytes wanted.
   (slice4)    Executor memory: 32709K bytes avg x 3 workers, 32709K bytes max (seg0).  Work_mem: 32576K bytes max.
 * (slice5)    Executor memory: 47387K bytes avg x 3 workers, 47389K bytes max (seg0).  Work_mem: 40453K bytes max, 1632544K bytes wanted.
   (slice6)    Executor memory: 1831K bytes avg x 3 workers, 1831K bytes max (seg0).  Work_mem: 1773K bytes max.
   (slice7)    Executor memory: 1086K bytes avg x 3 workers, 1086K bytes max (seg0).  Work_mem: 1025K bytes max.
   (slice8)    Executor memory: 38K bytes avg x 3 workers, 38K bytes max (seg0).
   (slice9)    Executor memory: 38K bytes avg x 3 workers, 38K bytes max (seg0).
 Memory used:  128000kB
 Memory wanted:  13062648kB
 Execution Time: 113180.690 ms
(100 rows)

