                                                                                                                             QUERY PLAN                                                                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=2838469.60..2838469.62 rows=1 width=32) (actual time=81887.723..81887.727 rows=1 loops=1)
   ->  Gather Motion 3:1  (slice1; segments: 3)  (cost=2838469.54..2838469.59 rows=3 width=32) (actual time=81798.927..81887.698 rows=3 loops=1)
         ->  Partial Aggregate  (cost=2838469.54..2838469.55 rows=1 width=32) (actual time=81795.948..81795.951 rows=1 loops=1)
               ->  Hash Join  (cost=1790824.01..2838225.51 rows=97610 width=8) (actual time=61039.393..81791.232 rows=5350 loops=1)
                     Hash Cond: (lineitem.l_partkey = part.p_partkey)
                     Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
                     Rows Removed by Join Filter: 54109
                     Extra Text: (seg0)   Hash chain length 1.0 avg, 3 max, using 5644 of 65536 buckets.
                     ->  Seq Scan on lineitem  (cost=0.00..886186.56 rows=59999456 width=17) (actual time=0.131..11522.874 rows=60003310 loops=1)
                     ->  Hash  (cost=1790457.97..1790457.97 rows=29283 width=40) (actual time=61033.339..61033.340 rows=5910 loops=1)
                           Buckets: 65536  Batches: 1  Memory Usage: 826kB
                           ->  Broadcast Motion 3:3  (slice2; segments: 3)  (cost=1728494.62..1790457.97 rows=29283 width=40) (actual time=50498.803..61031.657 rows=5910 loops=1)
                                 ->  Hash Join  (cost=1728494.62..1790067.53 rows=9761 width=40) (actual time=49463.508..60904.756 rows=2006 loops=1)
                                       Hash Cond: (lineitem_1.l_partkey = part.p_partkey)
                                       Extra Text: (seg1)   Hash chain length 1.0 avg, 2 max, using 1990 of 131072 buckets.
                                       ->  Finalize HashAggregate  (cost=1728239.54..1766536.09 rows=1835940 width=36) (actual time=49453.138..60425.351 rows=2001127 loops=1)
                                             Group Key: lineitem_1.l_partkey
                                             Planned Partitions: 8
                                             Extra Text: (seg0)   hash table(s): 1; 1999439 groups total in 72 batches, 46658776 spill partitions; disk usage: 383008KB; chain length 2.1 avg, 6 max; using 1999439 of 19136512 buckets; total 0 expansions.
 
                                             ->  Redistribute Motion 3:3  (slice3; segments: 3)  (cost=0.19..1643901.18 rows=5507811 width=36) (actual time=0.029..43271.912 rows=6003137 loops=1)
                                                   Hash Key: lineitem_1.l_partkey
                                                   ->  Partial GroupAggregate  (cost=0.19..1533744.95 rows=5507811 width=36) (actual time=0.473..46131.890 rows=5999772 loops=1)
                                                         Group Key: lineitem_1.l_partkey
                                                         ->  Index Only Scan using lineitem_l_partkey_l_suppkey_l_shipdate_l_quantity_idx on lineitem lineitem_1  (cost=0.19..1164900.03 rows=59999456 width=9) (actual time=0.240..19701.895 rows=60003310 loops=1)
                                                               Heap Fetches: 0
                                       ->  Hash  (cost=122.16..122.16 rows=10633 width=4) (actual time=3.465..3.466 rows=2006 loops=1)
                                             Buckets: 131072  Batches: 1  Memory Usage: 1095kB
                                             ->  Index Only Scan using part_p_container_p_brand_p_partkey_idx on part  (cost=0.18..122.16 rows=10633 width=4) (actual time=0.980..3.028 rows=2006 loops=1)
                                                   Index Cond: ((p_container = 'SM BOX'::bpchar) AND (p_brand = 'Brand#53'::bpchar))
                                                   Heap Fetches: 0
 Optimizer: Postgres-based planner
 Planning Time: 24.690 ms
   (slice0)    Executor memory: 6247K bytes.
   (slice1)    Executor memory: 877K bytes avg x 3 workers, 877K bytes max (seg0).  Work_mem: 826K bytes max.
 * (slice2)    Executor memory: 20944K bytes avg x 3 workers, 21018K bytes max (seg2).  Work_mem: 33329K bytes max, 1032209K bytes wanted.
   (slice3)    Executor memory: 123K bytes avg x 3 workers, 123K bytes max (seg0).
 Memory used:  128000kB
 Memory wanted:  3097724kB
 Execution Time: 81906.513 ms
(40 rows)

